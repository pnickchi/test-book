<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Appendix B — Simulated Datasets – The Mini Test Book (in development)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../book/A-greek-alphabet.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f664b88e837a53bca78c5b20234386e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.33/datatables.js"></script><script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../custom.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">The Mini Test Book (in development)</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/pnickchi/test-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/A-greek-alphabet.html">Appendices</a></li><li class="breadcrumb-item"><a href="../book/B-simulated-datasets.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Simulated Datasets</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../img/toolkit.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/meet-the-authors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meet the Authors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/privacy-policy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Website Privacy Policy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter1-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter2-one-pop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tests for One Continuous Population Mean</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter3-two-pop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tests for Two Continuous Population Mean</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter4-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">ANOVA-related Tests for <span class="math inline">\(k\)</span> Continuous Population Means</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter5-chi-square.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Chapter 5: Chi-square Tests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/A-greek-alphabet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Greek Alphabet</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/B-simulated-datasets.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Simulated Datasets</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">The content</h2>
   
  <ul>
<li>
<a href="#t-test-for-paired-samples-dataset" id="toc-t-test-for-paired-samples-dataset" class="nav-link active" data-scroll-target="#t-test-for-paired-samples-dataset"><span class="header-section-number">B.1</span> <span class="math inline">\(t\)</span>-test for Paired Samples Dataset</a>
  <ul>
<li><a href="#generative-modelling-process" id="toc-generative-modelling-process" class="nav-link" data-scroll-target="#generative-modelling-process"><span class="header-section-number">B.1.1</span> Generative Modelling Process</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code"><span class="header-section-number">B.1.2</span> Code</a></li>
  </ul>
</li>
  <li>
<a href="#anova-datasets" id="toc-anova-datasets" class="nav-link" data-scroll-target="#anova-datasets"><span class="header-section-number">B.2</span> ANOVA Datasets</a>
  <ul>
<li>
<a href="#sec-one-way-ANOVA-sim" id="toc-sec-one-way-ANOVA-sim" class="nav-link" data-scroll-target="#sec-one-way-ANOVA-sim"><span class="header-section-number">B.2.1</span> One-way ANOVA</a>
  <ul class="collapse">
<li><a href="#generative-modelling-process-1" id="toc-generative-modelling-process-1" class="nav-link" data-scroll-target="#generative-modelling-process-1">Generative Modelling Process</a></li>
  <li><a href="#code-1" id="toc-code-1" class="nav-link" data-scroll-target="#code-1">Code</a></li>
  </ul>
</li>
  <li>
<a href="#sec-two-way-ANOVA-sim" id="toc-sec-two-way-ANOVA-sim" class="nav-link" data-scroll-target="#sec-two-way-ANOVA-sim"><span class="header-section-number">B.2.2</span> Two-way ANOVA</a>
  <ul class="collapse">
<li><a href="#generative-modelling-process-2" id="toc-generative-modelling-process-2" class="nav-link" data-scroll-target="#generative-modelling-process-2">Generative Modelling Process</a></li>
  <li><a href="#code-2" id="toc-code-2" class="nav-link" data-scroll-target="#code-2">Code</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/pnickchi/test-book/edit/main/book/B-simulated-datasets.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/pnickchi/test-book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/pnickchi/test-book/blob/main/book/B-simulated-datasets.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/A-greek-alphabet.html">Appendices</a></li><li class="breadcrumb-item"><a href="../book/B-simulated-datasets.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Simulated Datasets</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-simulated-datasets" class="quarto-section-identifier">Appendix B — Simulated Datasets</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!-- Google tag (gtag.js) --><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DZWGQVJSHE"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-DZWGQVJSHE');
</script><p>While we have made an effort to include real datasets wherever possible in this mini-book, we will utilize simulated data to demonstrate the application of the <strong>test workflow</strong> from <a href="chapter1-intro.html" class="quarto-xref"><span>Chapter 1</span></a> for certain hypothesis testings. This simulation-based approach allows us to have suitable datasets to illustrate how each test’s modelling assumptions must be satisfied to ensure that we deliver robust inferential conclusions to our stakeholders. Therefore, this appendix will explain the <strong>generative modelling process</strong> used to create these simulated datasets.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/help.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>Image by <a href="https://pixabay.com/users/manfredsteger-1848497/"><em>manfredsteger</em></a> via <a href="https://pixabay.com/vectors/pixel-cells-help-assistance-3974184/"><em>Pixabay</em></a>.</figcaption></figure>
</div>
<div class="Heads-up">
<div class="Heads-up-header">
<p>Heads-up on the language chosen to simulate the datasets in the mini-book’s main chapters!</p>
</div>
<div class="Heads-up-container">
<p>To maintain a bilingual approach using both <code>R</code> and <code>Python</code>, we will provide the code for generating the datasets in both languages within this appendix. However, <strong>in the main chapters</strong>, we will rely on the data points from the <code>R</code>-generated set while conducting the inferential analysis using both programming languages. This decision is made because there is a discrepancy between the datasets simulated by the two languages, even when using the <strong>same simulation seed</strong>, due to their <strong>distinct pseudo-random number generators</strong>.</p>
</div>
</div>
<p>For each of the datasets listed below, besides providing the simulation code, we will elaborate on the dataset context along with the relevant equations (if necessary) that generate this data.</p>
<section id="t-test-for-paired-samples-dataset" class="level2" data-number="B.1"><h2 data-number="B.1" class="anchored" data-anchor-id="t-test-for-paired-samples-dataset">
<span class="header-section-number">B.1</span> <span class="math inline">\(t\)</span>-test for Paired Samples Dataset</h2>
<p>This dataset is used in <a href="chapter3-two-pop.html" class="quarto-xref"><span>Chapter 3</span></a>, more specifically in <a href="chapter3-two-pop.html#sec-t-test-paired-samples" class="quarto-xref"><span>Section 3.4</span></a>, to demonstrate the <strong><span class="math inline">\(t\)</span>-test for paired samples</strong> via a hypothetical scenario from medical research. Consider a clinical investigation examining whether an innovative medication can decrease low-density lipoprotein (LDL) cholesterol levels in adults diagnosed with hypercholesterolemia, a condition characterized by elevated cholesterol levels in the blood. This matter can increase the risk of heart problems because cholesterol can build up in blood vessels and block blood flow.</p>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/cholesterol.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>Image by <a href="https://pixabay.com/users/fidsor-26066389/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=7070897"><em>Fakhruddin Memon</em></a> via <a href="https://pixabay.com/illustrations/heart-attack-heartache-stethoscope-7070897/"><em>Pixabay</em></a>.</figcaption></figure>
</div>
<p><br></p>
<div class="Heads-up">
<div class="Heads-up-header">
<p>Heads-up on the use of this dataset!</p>
</div>
<div class="Heads-up-container">
<p>This data is simulated and by no means should be considered for medical research or advice.</p>
</div>
</div>
<p>This simulated study monitors a group of <span class="math inline">\(n = 120\)</span> participants over time, recording LDL cholesterol concentrations prior to treatment and again after an eight-week course of the drug. The outcome of interest is the LDL cholesterol measurement (in <span class="math inline">\(\text{mg/dL}\)</span>), a widely used biomarker for cardiovascular risk. Since each participant provides two observations (i.e., one before and one after treatment), the data are naturally paired (the same individual is measured twice), allowing the analysis to focus on <strong>changes within individuals</strong> rather than <strong>differences between unrelated groups</strong>.</p>
<section id="generative-modelling-process" class="level3" data-number="B.1.1"><h3 data-number="B.1.1" class="anchored" data-anchor-id="generative-modelling-process">
<span class="header-section-number">B.1.1</span> Generative Modelling Process</h3>
<p>The simulated dataset reflects the following study characteristics:</p>
<ul>
<li>
<strong>Baseline LDL levels:</strong> Participants in the simulated population have a mean pre-treatment LDL cholesterol level of <span class="math inline">\(\mu = 160 \text{ mg/dL}\)</span>, with a standard deviation of <span class="math inline">\(\sigma = 5 \text{ mg/dL}\)</span> to account for individual variation.</li>
<li>
<strong>Expected treatment effect:</strong> On average, in this simulated population of participants, LDL cholesterol levels decline by <span class="math inline">\(\Delta = 2.5 \text{ mg/dL}\)</span> after the intervention using the new medication.</li>
<li>
<strong>Measurement variation:</strong> Biological variability and measurement error introduce random fluctuations in LDL values, even within the same patient.</li>
</ul>
<p>Since formally, for the <span class="math inline">\(i\)</span>th participant, the LDL cholesterol level before treatment is assumed to follow a Normal distribution with <span class="math inline">\(\mu = 160 \text{ mg/dL}\)</span> and <span class="math inline">\(\sigma = 5 \text{ mg/dL}\)</span>, we can express the following:</p>
<p><span class="math display">\[\text{LDL}_{\text{before}, i} \sim \text{Normal}(\mu = 160, \sigma^2= 5^2).\]</span></p>
<p>Then, again for the <span class="math inline">\(i\)</span>th participant, the LDL cholesterol level after the treatment is another random variable that is a combination of three components as follows:</p>
<p><span class="math display">\[\text{LDL}_{\text{after}, i} = \text{LDL}_{\text{before}, i} - \Delta + \varepsilon_i,\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\Delta = 2.5 \text{ mg/dL}\)</span> is the <strong>average decrease</strong> in LDL cholesterol level due to this new treatment in the simulated population.</li>
<li>
<span class="math inline">\(\varepsilon_i \sim \text{Normal}(0, 1)\)</span> represents additional variation specific to the after-treatment measurement for the <span class="math inline">\(i\)</span>th participant. This is what we already defined as the <strong>measurement variation</strong>.</li>
</ul></section><section id="code" class="level3" data-number="B.1.2"><h3 data-number="B.1.2" class="anchored" data-anchor-id="code">
<span class="header-section-number">B.1.2</span> Code</h3>
<p>Let us check the corresponding code to simulate this data. We are simulating <strong>120 participants in this study</strong>, which gives us a sample size of <span class="math inline">\(n = 120\)</span>. Additionally, the simulation will utilize the <a href="https://pypi.org/project/numpy/">{numpy}</a> <span class="citation" data-cites="numpy">(<a href="references.html#ref-numpy" role="doc-biblioref">Harris et al. 2020</a>)</span> and <a href="https://pypi.org/project/pandas/">{pandas}</a> libraries in <code>Python</code>. The final data frame will be stored in <code>cholesterol_data</code>, which will have the following columns: <code>patient_id</code>, <code>LDL_before</code>, and <code>LDL_after</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page"><strong><code>R</code> Code</strong></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><strong><code>Python</code> Code</strong></a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set number of participants</span></span>
<span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fl">120</span>   </span>
<span></span>
<span><span class="co"># Set the average decrease in LDL cholesterol levels due to new treatment</span></span>
<span><span class="va">Delta</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span></span>
<span><span class="co"># Step 1: Generate LDL cholesterol levels before treatment</span></span>
<span><span class="va">ldl_before</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_patients</span>, mean <span class="op">=</span> <span class="fl">160</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Generate LDL cholesterol levels after treatment</span></span>
<span><span class="va">ldl_after</span> <span class="op">&lt;-</span> <span class="va">ldl_before</span> <span class="op">-</span> <span class="va">Delta</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_patients</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create final dataset</span></span>
<span><span class="va">cholesterol_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_patients</span>,</span>
<span>  LDL_before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ldl_before</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  LDL_after  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ldl_after</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Showing the first 20 participants </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cholesterol_data</span>, <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing libraries</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set number of participants</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>n_patients <span class="op">=</span> <span class="dv">120</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the average decrease in LDL cholesterol levels due to new treatment</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>Delta <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Generate LDL cholesterol levels before treatment</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>ldl_before <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">160</span>, scale<span class="op">=</span><span class="dv">5</span>, size<span class="op">=</span>n_patients)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Generate LDL cholesterol levels after treatment</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>ldl_after <span class="op">=</span> ldl_before <span class="op">-</span> Delta <span class="op">+</span> np.random.normal(loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">1</span>, size<span class="op">=</span>n_patients)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create final dataset</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>cholesterol_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"patient_id"</span>: np.arange(<span class="dv">1</span>, n_patients <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"LDL_before"</span>: np.<span class="bu">round</span>(ldl_before, <span class="dv">1</span>),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"LDL_after"</span>: np.<span class="bu">round</span>(ldl_after, <span class="dv">1</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Showing the first 20 participants </span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cholesterol_data.head(<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><strong><code>R</code> Output</strong></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><strong><code>Python</code> Output</strong></a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-155dc90fc4a3b1a0cf9b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-155dc90fc4a3b1a0cf9b">{"x":{"filter":"none","vertical":false,"data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],[157.2,158.8,167.8,160.4,160.6,168.6,162.3,153.7,156.6,157.8,166.1,161.8,162,160.6,157.2,168.9,162.5,150.2,163.5,157.6],[154.8,155.4,164.8,157.6,160,165.4,160,151.3,153.1,155.2,165.1,159.8,159.5,157.6,152.7,167.6,158.5,148.4,162.9,153.7]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>patient_id<\/th>\n      <th>LDL_before<\/th>\n      <th>LDL_after<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"ltipr","autoWidth":true,"columnDefs":[{"className":"dt-left","targets":"_all"},{"width":"200px","targets":"_all"},{"name":"patient_id","targets":0},{"name":"LDL_before","targets":1},{"name":"LDL_after","targets":2}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-b00bb49b4131cbaeb274" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b00bb49b4131cbaeb274">{"x":{"filter":"none","vertical":false,"data":[[1,2,3,4,5,6,7,8,9,10],[154.6,165,161.4,152.5,157.1,168.3,147.9,157.9,166.3,155.7],[151.8,161.9,159,150.7,156.2,165.5,146.2,155.9,164.3,152.6]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>patient_id<\/th>\n      <th>LDL_before<\/th>\n      <th>LDL_after<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"ltipr","autoWidth":true,"columnDefs":[{"className":"dt-left","targets":"_all"},{"width":"200px","targets":"_all"},{"name":"patient_id","targets":0},{"name":"LDL_before","targets":1},{"name":"LDL_after","targets":2}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="anova-datasets" class="level2" data-number="B.2"><h2 data-number="B.2" class="anchored" data-anchor-id="anova-datasets">
<span class="header-section-number">B.2</span> ANOVA Datasets</h2>
<p>These datasets are used in <a href="chapter4-anova.html" class="quarto-xref"><span>Chapter 4</span></a> to elaborate on <strong>analysis of variance (ANOVA)</strong> and pertain to an experimental context. Suppose a data-driven marketing team at a well-known tech company, which operates a global online store, is conducting two different A/B/n testings aimed at <strong>increasing the customer conversion score (i.e., the outcome)</strong>. In these experiments, the customer conversion score is defined as a unitless and standardized engagement index. This index combines various elements, such as clicks, time spent on the webpage, and the probability of making a purchase, with a baseline mean set at <span class="math inline">\(50\)</span>. This score measures customer responsiveness on the online store: <strong>the higher the score, the greater the customer responsiveness</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/ads.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Image by <a href="https://pixabay.com/users/pabitrakaity-7844390/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6370790"><em>Pabitra Kaity</em></a> via <a href="https://pixabay.com/illustrations/ads-digital-marketing-advertisements-6370790/"><em>Pixabay</em></a>.</figcaption></figure>
</div>
<section id="sec-one-way-ANOVA-sim" class="level3" data-number="B.2.1"><h3 data-number="B.2.1" class="anchored" data-anchor-id="sec-one-way-ANOVA-sim">
<span class="header-section-number">B.2.1</span> One-way ANOVA</h3>
<p>Let us start by outlining the generative modelling process for a <strong>one-way ANOVA experiment</strong>. In this context, we will simulate a dataset that represents a continuous response variable (in this case, the customer conversion score) affected by a <strong>single experimental factor</strong>, specifically the design of a webpage. This setup allows us to assess whether the average response systematically varies across different design options.</p>
<section id="generative-modelling-process-1" class="level4"><h4 class="anchored" data-anchor-id="generative-modelling-process-1">Generative Modelling Process</h4>
<p>The experiment involves <strong>webpage design</strong> as a <strong>controllable factor</strong> determined by the experimenter. This factor includes three different layouts: <span class="math inline">\(D_1\)</span> (the current layout), <span class="math inline">\(D_2\)</span> (a new layout), and <span class="math inline">\(D_3\)</span> (another new layout), making it a three-level factor. This study will be conducted as a <strong>full factorial experiment</strong> characterized by the following elements:</p>
<ul>
<li>One factor, namely, <strong>webpage design</strong>.</li>
<li>There are <span class="math inline">\(3\)</span> treatments (i.e., the above three factor levels), which classifies this study as A/B/n testing.</li>
<li>We will simulate 200 customers (i.e., <strong>replicates</strong>) per treatment in our final dataset.</li>
<li>The outcome variable <span class="math inline">\(Y\)</span> is the customer conversion score, which has been previously explained.</li>
</ul>
<p>Our data structure will be an <strong>additive model</strong> conceptually depicted as:</p>
<p><span id="eq-ANOVA-conceptual-model-app-one"><span class="math display">\[
\begin{align*}
\text{Outcome} &amp;= \text{First Main Effect} + \text{Random Error}.
\end{align*}
\tag{B.1}\]</span></span></p>
<p>Then, for the data generation process, let <span class="math inline">\(Y_{i,k}\)</span> represent the customer conversion score for the <span class="math inline">\(k\)</span>th replicate of the treatment related to the <span class="math inline">\(i\)</span>th webpage design level. <a href="#eq-ANOVA-conceptual-model-app-one" class="quarto-xref">Equation&nbsp;<span>B.1</span></a> is translated as:</p>
<p><span id="eq-ANOVA-math-model-app-one"><span class="math display">\[
Y_{i,k} = \alpha_i + \varepsilon_{i,k},
\tag{B.2}\]</span></span></p>
<p>where</p>
<ul>
<li>
<span class="math inline">\(\alpha_i\)</span> is the fixed main effect corresponding to the <span class="math inline">\(i\)</span>th level of webpage design for <span class="math inline">\(i = D_1, D_2, D_3\)</span>;</li>
<li>
<span class="math inline">\(\varepsilon_{i,k}\)</span> is the random error associated to each <span class="math inline">\(Y_{i,k}\)</span>, capturing the variability and measurement error that introduces randomness in the response <span class="math inline">\(Y_{i,k}\)</span>.</li>
</ul>
<p>In this case, <a href="#eq-ANOVA-math-model-app-one" class="quarto-xref">Equation&nbsp;<span>B.2</span></a> breaks down the outcome on the right-hand side into two additive components, which serve as the foundation for how ANOVA models the data. Unlike the random error <span class="math inline">\(\varepsilon_{i,k}\)</span>, the term <span class="math inline">\(\alpha_i\)</span> is assumed to be fixed within the data-generating process, as we are using a <strong>frequentist approach</strong>. Since <span class="math inline">\(\varepsilon_{i,k}\)</span> is random, we will assume it follows a Normal distribution with a mean of <span class="math inline">\(0\)</span> and a variance of <span class="math inline">\(\sigma^2\)</span>, which is another fixed parameter in the simulation:</p>
<p><span class="math display">\[
\varepsilon_{i,k} \sim \text{Normal}(0, \sigma^2).
\]</span> In terms of our simulation, imagine you have a population of customers with the following fixed parameters:</p>
<ul>
<li>A vector of webpage design effects (i.e., the main effect)</li>
</ul>
<p><span class="math display">\[\boldsymbol{\alpha} =
\begin{bmatrix} \alpha_{D_1} \\ \alpha_{D_2} \\ \alpha_{D_3} \end{bmatrix} =
\begin{bmatrix} 60 \\ 60 \\ 60 \end{bmatrix}.\]</span></p>
<ul>
<li>An overall variance</li>
</ul>
<p><span class="math display">\[
\sigma^2 = 10.
\]</span></p>
<p>The rationale for this simulation setup lies in constructing a <strong>baseline generative process</strong> that explicitly embodies the null hypothesis of a one-way ANOVA. By assigning identical mean effects to all three webpage designs, we model a population in which, on average, each webpage design yields the same customer conversion performance (that is, all group means are equal as specified in the vector <span class="math inline">\(\boldsymbol{\alpha}\)</span>). Consequently, any observed differences among sample means arise purely from <strong>random sampling variability</strong>, not from systematic treatment effects.</p>
<p>In addition, this generative design encodes two fundamental assumptions of the ANOVA framework: <strong>normality</strong> and <strong>homoscedasticity</strong>. The normality assumption on the random component <span class="math inline">\(\varepsilon_{i,k}\)</span> ensures that each group’s response distribution is symmetric and bell-shaped, supporting the validity of parametric inference represented by the <span class="math inline">\(F\)</span>-test in ANOVA. The homoscedasticity assumption (expressed here as a constant variance <span class="math inline">\(\sigma^2 = 10\)</span>) asserts that the <strong>variability</strong> in customer responses is <strong>identical</strong> across all webpage designs. This condition guarantees that any detected mean differences can be attributed to true design effects rather than unequal levels of random noise.</p>
</section><section id="code-1" class="level4"><h4 class="anchored" data-anchor-id="code-1">Code</h4>
<p>Let us move to the corresponding code to simulate this data. Recall we are simulating <strong>200 customers for each one of the three treatments</strong>, which will give us an <strong>overall sample size of <span class="math inline">\(n = 600\)</span></strong>. Furthermore, note that <code>Python</code> additionally uses the <a href="https://pypi.org/project/numpy/">{numpy}</a> and <a href="https://pypi.org/project/pandas/">{pandas}</a> libraries. The final data frame will be stored in <code>ABn_customer_data_one_factor</code> whose columns will be <code>webpage_design</code> and <code>conversion_score</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><strong><code>R</code> Code</strong></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><strong><code>Python</code> Code</strong></a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Factor levels and sampled customers per treatment</span></span>
<span><span class="va">webpage_design_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="st">"D3"</span><span class="op">)</span></span>
<span><span class="va">n_per_treatment</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># Population fixed additive parameters</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulating data</span></span>
<span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mean_i</span> <span class="op">&lt;-</span> <span class="va">alpha</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_per_treatment</span>, mean <span class="op">=</span> <span class="va">mean_i</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">df_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    webpage_design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">webpage_design_levels</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    conversion_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">data_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">data_list</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df_i</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ABn_customer_data_one_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">data_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Showing the first 100 customers of the A/B/n testing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ABn_customer_data_one_factor</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing libraries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor levels and sampled customers per treatment</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>webpage_design_levels <span class="op">=</span> [<span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="st">"D3"</span>]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>n_per_treatment <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Population fixed additive parameters</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> [<span class="dv">60</span>, <span class="dv">60</span>, <span class="dv">60</span>]          </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulating data</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>data_list <span class="op">=</span> []</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):  </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>      mean_i <span class="op">=</span> alpha[i]</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>      y <span class="op">=</span> np.random.normal(loc<span class="op">=</span>mean_i, scale<span class="op">=</span>np.sqrt(<span class="dv">10</span>), size <span class="op">=</span> n_per_treatment)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>      y_rounded <span class="op">=</span> np.<span class="bu">round</span>(y, <span class="dv">2</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>      df_i <span class="op">=</span> pd.DataFrame({</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>          <span class="st">'webpage_design'</span>: [webpage_design_levels[i]] <span class="op">*</span> n_per_treatment,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>          <span class="st">'conversion_score'</span>: y_rounded</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>      data_list.append(df_i)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate all groups into one DataFrame</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>ABn_customer_data_one_factor <span class="op">=</span> pd.concat(data_list, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Showing the first 100 customers of the A/B/n testing</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ABn_customer_data.head(<span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><strong><code>R</code> Output</strong></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><strong><code>Python</code> Output</strong></a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-85cf7f798e923a02ed60" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-85cf7f798e923a02ed60">{"x":{"filter":"none","vertical":false,"data":[["D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1"],[58.23,59.27,64.93000000000001,60.22,60.41,65.42,61.46,56,57.83,58.59,63.87,61.14,61.27,60.35,58.24,65.65000000000001,61.57,53.78,62.22,58.5,56.62,59.31,56.76,57.7,58.02,54.67,62.65,60.49,56.4,63.96,61.35,59.07,62.83,62.78,62.6,62.18,61.75,59.8,59.03,58.8,57.8,59.34,56,66.86,63.82,56.45,58.73,58.52,62.47,59.74,60.8,59.91,59.86,64.33,59.29,64.8,55.1,61.85,60.39,60.68,61.2,58.41,58.95,56.78,56.61,60.96,61.42,60.17,62.92,66.48,58.45,52.7,63.18,57.76,57.82,63.24,59.1,56.14,60.57,59.56,60.02,61.22,58.83,62.04,59.3,61.05,63.47,61.38,58.97,63.63,63.14,61.73,60.75,58.01,64.3,58.1,66.92,64.84999999999999,59.25,56.75]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>webpage_design<\/th>\n      <th>conversion_score<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"ltipr","autoWidth":true,"columnDefs":[{"className":"dt-left","targets":"_all"},{"width":"200px","targets":"_all"},{"name":"webpage_design","targets":0},{"name":"conversion_score","targets":1}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f7202f4a63f76b2c09a9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f7202f4a63f76b2c09a9">{"x":{"filter":"none","vertical":false,"data":[["D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1"],[56.57,63.15,60.89,55.24,58.17,65.22,52.33,58.64,64,57.26,57.85,59.7,64.72,57.98,58.6,58.63,66.98,66.92,63.18,61.22,62.33,64.70999999999999,57.04,63.72,56.03,57.98,62.87,55.48,59.56,57.27,59.19,51.15,54.4,57.79,62.93,59.45,60.01,62.18,57.22,60.9,57.45,54.54,58.76,61.81,61.07,59.96,67.56999999999999,61.31,63.1,67.08,55.91,56.72,65.51000000000001,57.48,60.09,63.38,62.82,65.55,64.73,63.38,57.56,62.51,60.99,55.81,64.48,62.55,60.14,59.26,56.21,60.63,61.48,57.37,63.68,56.53,53.29,63.29,58.72,59.6,57.35,54.92,63.97,57.82,65.25,62.55,59,56.57,57.68,56.17,66.59999999999999,60.52,63.64,55.99,60.57,63.72,58.94,63.26,56.57,55.69,61.2,58.8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>webpage_design<\/th>\n      <th>conversion_score<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"ltipr","autoWidth":true,"columnDefs":[{"className":"dt-left","targets":"_all"},{"width":"200px","targets":"_all"},{"name":"webpage_design","targets":0},{"name":"conversion_score","targets":1}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="sec-two-way-ANOVA-sim" class="level3" data-number="B.2.2"><h3 data-number="B.2.2" class="anchored" data-anchor-id="sec-two-way-ANOVA-sim">
<span class="header-section-number">B.2.2</span> Two-way ANOVA</h3>
<p>Let us extend our generative modelling framework to a <strong>two-way ANOVA</strong> experiment. In this context, we will simulate a dataset that represents a continuous response variable (i.e., the customer conversion score) affected by <strong>two experimental factors</strong>: webpage design and discount framing strategy. Each factor has its own <strong>main effect</strong> on the response, and their combination may also result in an <strong>interaction effect</strong>, which indicates how the impact of one factor depends on the level of the other. This setup allows us to assess whether variations in customer conversion arise from the individual effects of design and discount framing, as well as their combined influence. This approach offers a more comprehensive understanding of experimental variation and aids in practical decision-making.</p>
<section id="generative-modelling-process-2" class="level4"><h4 class="anchored" data-anchor-id="generative-modelling-process-2">Generative Modelling Process</h4>
<p>This second experiment has the following <strong>controllable factors</strong> by the experimenter:</p>
<ul>
<li>
<strong>Webpage design:</strong> Three different layouts <span class="math inline">\(D_1\)</span> (the current layout), <span class="math inline">\(D_2\)</span> (a new layout), and <span class="math inline">\(D_3\)</span> (another new layout). This makes a three-level factor.</li>
<li>
<strong>Discount framing:</strong> <span class="math inline">\(\text{Low}\)</span> (i.e., “<em>Save 10% today</em>”) or <span class="math inline">\(\text{High}\)</span> (i.e., “<em>Save up to 40% today</em>”). This makes a two-level factor.</li>
</ul>
<p>This study will be a <strong>full factorial experiment</strong> characterized by the following elements:</p>
<ul>
<li>Two factors: <strong>webpage design</strong> and <strong>discount framing</strong>.</li>
<li>There are <span class="math inline">\(3 \times 2 = 6\)</span> treatments (i.e., six different combinations of all the factor levels), which classifies this study as A/B/n testing.</li>
<li>We will simulate 200 customers (i.e., <strong>replicates</strong>) per treatment in our final dataset.</li>
<li>The outcome variable <span class="math inline">\(Y\)</span> is the customer conversion score, which has been previously explained.</li>
</ul>
<p>Our data structure will be an <strong>additive model</strong> conceptually depicted as:</p>
<p><span id="eq-ANOVA-conceptual-model-app-two"><span class="math display">\[
\begin{align*}
\text{Outcome} &amp;= \text{First Main Effect} + \text{Second Main Effect} + \\
&amp; \qquad \text{Interaction Effect} + \text{Random Error}.
\end{align*}
\tag{B.3}\]</span></span></p>
<p>Then, for the data generation process, let <span class="math inline">\(Y_{i,j,k}\)</span> represent the customer conversion score for the <span class="math inline">\(k\)</span>th replicate of the treatment related to the <span class="math inline">\(i\)</span>th webpage design and the <span class="math inline">\(j\)</span>th discount framing levels. <a href="#eq-ANOVA-conceptual-model-app-two" class="quarto-xref">Equation&nbsp;<span>B.3</span></a> is translated as:</p>
<p><span id="eq-ANOVA-math-model-app-two"><span class="math display">\[
Y_{i,j,k} = \alpha_i + \beta_j + (\alpha \beta)_{i,j} + \varepsilon_{i,j,k},
\tag{B.4}\]</span></span></p>
<p>where</p>
<ul>
<li>
<span class="math inline">\(\alpha_i\)</span> is the fixed first main effect corresponding to the <span class="math inline">\(i\)</span>th level of webpage design for <span class="math inline">\(i = D_1, D_2, D_3\)</span>;</li>
<li>
<span class="math inline">\(\beta_j\)</span> is the second fixed main effect corresponding to the <span class="math inline">\(j\)</span>th level of discount framing for <span class="math inline">\(j = \text{Low}, \text{High}\)</span>;</li>
<li>
<span class="math inline">\((\alpha \beta)_{i,j}\)</span> is the fixed interaction effect between the <span class="math inline">\(i\)</span>th and <span class="math inline">\(j\)</span>th levels of webpage design and discount framing respectively, and</li>
<li>
<span class="math inline">\(\varepsilon_{i,j,k}\)</span> is the random error associated to each <span class="math inline">\(Y_{i,j,k}\)</span>, capturing the variability and measurement error that introduces randomness in the response <span class="math inline">\(Y_{i,j,k}\)</span>.</li>
</ul>
<div class="Heads-up">
<div class="Heads-up-header">
<p>Heads-up on the mathematical representation of the interaction term!</p>
</div>
<div class="Heads-up-container">
<p>The <span class="math inline">\((\alpha \beta)_{i,j}\)</span> in <a href="#eq-ANOVA-math-model-app-two" class="quarto-xref">Equation&nbsp;<span>B.4</span></a> <strong>does not</strong> indicate that the main effects are multiplying each other. Mathematically, it is just another additive term on the right-hand side of the equation.</p>
</div>
</div>
<p>In this case, <a href="#eq-ANOVA-math-model-app-two" class="quarto-xref">Equation&nbsp;<span>B.4</span></a> is breaking down the outcome on the right-hand side into four additive components, which form the basis on how ANOVA models the data. With the exception of the random error <span class="math inline">\(\varepsilon_{i,j,k}\)</span>, the other three terms are assumed to be fixed within the data-generating process, given that we are using a <strong>frequentist approach</strong>. Since <span class="math inline">\(\varepsilon_{i,j,k}\)</span> is random, we will assume that it follows a Normal distribution with a mean of <span class="math inline">\(0\)</span> and a variance of <span class="math inline">\(\sigma^2\)</span> (which is another fixed parameter in the simulation):</p>
<p><span class="math display">\[
\varepsilon_{i,j,k} \sim \text{Normal}(0, \sigma^2).
\]</span></p>
<p>In terms of our simulation, imagine you have a population of customers with the following fixed parameters:</p>
<ul>
<li>A vector of webpage design effects (i.e., the first main effect)</li>
</ul>
<p><span class="math display">\[\boldsymbol{\alpha} =
\begin{bmatrix} \alpha_{D_1} \\ \alpha_{D_2} \\ \alpha_{D_3} \end{bmatrix} =
\begin{bmatrix} 40 \\ 50 \\ 60 \end{bmatrix}.\]</span></p>
<ul>
<li>A vector of discount framing effects (i.e., the second main effect)</li>
</ul>
<p><span class="math display">\[\boldsymbol{\beta} =
\begin{bmatrix} \alpha_{\text{Low}} \\ \alpha_{\text{High}} \end{bmatrix} =
\begin{bmatrix} -6 \\ 6 \end{bmatrix}.\]</span></p>
<ul>
<li>A matrix of interaction effects, whose rows correspond to the levels of webpage design and columns to the levels of discount framing,</li>
</ul>
<p><span class="math display">\[
\boldsymbol{(\alpha \beta)} =
\begin{bmatrix}
(\alpha \beta)_{D_1,\text{Low}} &amp; (\alpha \beta)_{D_1,\text{High}} \\
(\alpha \beta)_{D_2,\text{Low}} &amp; (\alpha \beta)_{D_2,\text{High}} \\
(\alpha \beta)_{D_3,\text{Low}} &amp; (\alpha \beta)_{D_3,\text{High}}
\end{bmatrix} =
\begin{bmatrix}
0 &amp; 5 \\
4 &amp; 6 \\
8 &amp; -12
\end{bmatrix}.
\]</span></p>
<ul>
<li>An overall variance</li>
</ul>
<p><span class="math display">\[
\sigma^2 = 16.
\]</span></p>
<p>The purpose of this simulation is to define a <strong>generative process</strong> that captures the essential structure of a two-way ANOVA design. In this setting, both webpage design and discount framing are treated as controlled experimental factors, each contributing to the overall pattern of customer conversion scores. By specifying fixed main effects for each factor and an accompanying matrix of interaction effects, we represent a population where conversion performance arises from both individual influences and their <strong>combined interplay</strong>. This design enables us to study how the effect of one factor may depend on the level of the other, which is an idea central to interpreting two-way ANOVA outcomes.</p>
<p>Moreover, the simulation is grounded in the core distributional assumptions of the ANOVA framework: <strong>normality</strong> and <strong>homoscedasticity</strong>. The random term <span class="math inline">\(\varepsilon_{i,j,k}\)</span> is assumed to follow a Normal distribution, ensuring that the response within each treatment combination is approximately symmetric and well-behaved. The homoscedasticity condition, specified through a constant variance <span class="math inline">\(\sigma^2 = 16\)</span>, implies that the degree of <strong>variability</strong> in customer responses remains <strong>consistent</strong> across all combinations of factors. These assumptions provide the stability necessary for the <span class="math inline">\(F\)</span>-test to reliably separate true factor effects from random fluctuations.</p>
</section><section id="code-2" class="level4"><h4 class="anchored" data-anchor-id="code-2">Code</h4>
<p>Let us move to the corresponding code to simulate this data. Recall we are simulating <strong>200 customers for each one of the six treatments</strong>, which will give us an <strong>overall sample size of <span class="math inline">\(n = 1,200\)</span></strong>. Furthermore, note that <code>Python</code> additionally uses the <a href="https://pypi.org/project/numpy/">{numpy}</a> and <a href="https://pypi.org/project/pandas/">{pandas}</a> libraries. The final data frame will be stored in <code>ABn_customer_data_two_factors</code> whose columns will be <code>webpage_design</code>, <code>discount_framing</code>, and <code>conversion_score</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><strong><code>R</code> Code</strong></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><strong><code>Python</code> Code</strong></a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Factor levels and sampled customers per treatment</span></span>
<span><span class="va">webpage_design_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="st">"D3"</span><span class="op">)</span></span>
<span><span class="va">discount_framing_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"High"</span><span class="op">)</span></span>
<span><span class="va">n_per_treatment</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># Population fixed additive parameters</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span><span class="op">)</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">0</span>, <span class="fl">5</span>,</span>
<span>    <span class="fl">4</span>, <span class="fl">6</span>,</span>
<span>    <span class="fl">8</span>, <span class="op">-</span><span class="fl">12</span></span>
<span>  <span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulating data</span></span>
<span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mean_ij</span> <span class="op">&lt;-</span> <span class="va">alpha</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">interaction</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_per_treatment</span>, mean <span class="op">=</span> <span class="va">mean_ij</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">df_ij</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>      webpage_design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">webpage_design_levels</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      discount_framing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">discount_framing_levels</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      conversion_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">data_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">data_list</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df_ij</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ABn_customer_data_two_factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">data_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Showing the first 100 customers of the A/B/n testing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ABn_customer_data_two_factors</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing libraries</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor levels and sampled customers per treatment</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>webpage_design_levels <span class="op">=</span> [<span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="st">"D3"</span>]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>discount_framing_levels <span class="op">=</span> [<span class="st">"Low"</span>, <span class="st">"High"</span>]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>n_per_treatment <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Population fixed additive parameters</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> [<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>]          </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> [<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>]              </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>interaction <span class="op">=</span> np.array([</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>, <span class="dv">5</span>],</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">4</span>, <span class="dv">6</span>],</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">8</span>, <span class="op">-</span><span class="dv">12</span>]</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulating data</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>data_list <span class="op">=</span> []</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):  </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):  </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        mean_ij <span class="op">=</span> alpha[i] <span class="op">+</span> beta[j] <span class="op">+</span> interaction[i, j]</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> np.random.normal(loc<span class="op">=</span>mean_ij, scale<span class="op">=</span>np.sqrt(<span class="dv">16</span>), size <span class="op">=</span> n_per_treatment)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        y_rounded <span class="op">=</span> np.<span class="bu">round</span>(y, <span class="dv">2</span>) </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        df_ij <span class="op">=</span> pd.DataFrame({</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'webpage_design'</span>: [webpage_design_levels[i]] <span class="op">*</span> n_per_treatment,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'discount_framing'</span>: [discount_framing_levels[j]] <span class="op">*</span> n_per_treatment,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'conversion_score'</span>: y_rounded</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>        data_list.append(df_ij)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate all groups into one DataFrame</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>ABn_customer_data_two_factors <span class="op">=</span> pd.concat(data_list, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Showing the first 100 customers of the A/B/n testing</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ABn_customer_data_two_factors.head(<span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><strong><code>R</code> Output</strong></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><strong><code>Python</code> Output</strong></a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-175be691d0d33a88348a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-175be691d0d33a88348a">{"x":{"filter":"none","vertical":false,"data":[["D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1"],["Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low"],[31.76,33.08,40.23,34.28,34.52,40.86,35.84,28.94,31.25,32.22,38.9,35.44,35.6,34.44,31.78,41.15,35.99,26.13,36.81,32.11,29.73,33.13,29.9,31.08,31.5,27.25,37.35,34.61,29.45,39.02,35.71,32.82,37.58,37.51,37.29,36.75,36.22,33.75,32.78,32.48,31.22,33.17,28.94,42.68,38.83,29.51,32.39,32.13,37.12,33.67,35.01,33.89,33.83,39.47,33.1,40.07,27.8,36.34,34.5,34.86,35.52,31.99,32.67,29.93,29.71,35.21,35.79,34.21,37.69,42.2,32.04,24.76,38.02,31.16,31.25,38.1,32.86,29.12,34.73,33.44,34.02,35.54,32.52,36.58,33.12,35.33,38.39,35.74,32.7,38.6,37.97,36.19,34.95,31.49,39.44,31.6,42.75,40.13,33.06,29.89]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>webpage_design<\/th>\n      <th>discount_framing<\/th>\n      <th>conversion_score<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"ltipr","autoWidth":true,"columnDefs":[{"className":"dt-left","targets":"_all"},{"width":"200px","targets":"_all"},{"name":"webpage_design","targets":0},{"name":"discount_framing","targets":1},{"name":"conversion_score","targets":2}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-6b0771041c3145491948" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6b0771041c3145491948">{"x":{"filter":"none","vertical":false,"data":[["D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1"],["Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low","Low"],[29.66,37.99,35.13,27.97,31.69,40.61,24.29,32.28,39.06,30.53,31.28,33.62,39.97,31.44,32.22,32.26,42.82,42.75,38.02,35.54,36.95,39.96,30.26,38.7,28.98,31.45,37.63,28.29,33.44,30.55,32.98,22.81,26.91,31.2,37.71,33.31,34.01,36.75,30.48,35.13,30.78,27.09,32.44,36.3,35.35,33.95,43.57,35.65,37.91,42.95,28.82,29.84,40.97,30.81,34.12,38.28,37.56,41.02,39.98,38.28,30.91,37.18,35.26,28.69,39.67,37.23,34.18,33.07,29.21,34.8,35.87,30.68,38.65,29.61,25.51,38.16,32.39,33.5,30.65,27.58,39.02,31.24,40.64,37.23,32.74,29.66,31.07,29.15,42.35,34.66,38.6,28.93,34.72,38.71,32.66,38.12,29.66,28.55,35.52,32.48]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>webpage_design<\/th>\n      <th>discount_framing<\/th>\n      <th>conversion_score<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"ltipr","autoWidth":true,"columnDefs":[{"className":"dt-left","targets":"_all"},{"width":"200px","targets":"_all"},{"name":"webpage_design","targets":0},{"name":"discount_framing","targets":1},{"name":"conversion_score","targets":2}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-numpy" class="csl-entry" role="listitem">
Harris, Charles R., K. Jarrod Millman, Stéfan J. van der Walt, Ralf Gommers, Pauli Virtanen, David Cournapeau, Eric Wieser, et al. 2020. <span>“Array Programming with <span>NumPy</span>.”</span> <em>Nature</em> 585 (7825): 357–62. <a href="https://doi.org/10.1038/s41586-020-2649-2">https://doi.org/10.1038/s41586-020-2649-2</a>.
</div>
</div>
</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pnickchi\.github\.io\/test-book\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../book/A-greek-alphabet.html" class="pagination-link" aria-label="Greek Alphabet">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Greek Alphabet</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025; G. Alexi Rodríguez-Arelis, Kate Manskaia, and Payman Nickchi<br><a href="https://www.flaticon.com/free-icon/toolkit_4229807?term=tool+box&amp;page=1&amp;position=24&amp;origin=tag&amp;related_id=4229807" title="toolkit icons">Toolkit icon created by Freepik - Flaticon</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/pnickchi/test-book/edit/main/book/B-simulated-datasets.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/pnickchi/test-book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/pnickchi/test-book/blob/main/book/B-simulated-datasets.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>
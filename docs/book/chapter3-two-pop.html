<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; Tests for Two Continuous Population Mean – The Mini Test Book (in development)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../book/chapter4-anova.html" rel="next">
<link href="../book/chapter2-one-pop.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script><script src="../site_libs/quarto-diagram/mermaid-init.js"></script><link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../custom.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">The Mini Test Book (in development)</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/pnickchi/test-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/chapter3-two-pop.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tests for Two Continuous Population Mean</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../img/toolkit.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/meet-the-authors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meet the Authors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/privacy-policy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Website Privacy Policy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter1-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter2-one-pop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tests for One Continuous Population Mean</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter3-two-pop.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tests for Two Continuous Population Mean</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter4-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">ANOVA-related Tests for <span class="math inline">\(k\)</span> Continuous Population Means</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/chapter5-chi-square.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Chi-squared Tests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/A-greek-alphabet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Greek Alphabet</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/B-simulated-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Simulated Datasets</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">The content</h2>
   
  <ul>
<li>
<a href="#sec-t-test-ind-samples" id="toc-sec-t-test-ind-samples" class="nav-link active" data-scroll-target="#sec-t-test-ind-samples"><span class="header-section-number">3.1</span> Two sample Student’s t-test for Independent Samples</a>
  <ul>
<li><a href="#review" id="toc-review" class="nav-link" data-scroll-target="#review"><span class="header-section-number">3.1.1</span> Review</a></li>
  <li><a href="#study-design" id="toc-study-design" class="nav-link" data-scroll-target="#study-design"><span class="header-section-number">3.1.2</span> Study design</a></li>
  <li><a href="#data-collection-and-wrangling" id="toc-data-collection-and-wrangling" class="nav-link" data-scroll-target="#data-collection-and-wrangling"><span class="header-section-number">3.1.3</span> Data Collection and Wrangling</a></li>
  <li><a href="#explanatory-data-analysis" id="toc-explanatory-data-analysis" class="nav-link" data-scroll-target="#explanatory-data-analysis"><span class="header-section-number">3.1.4</span> Explanatory Data Analysis</a></li>
  <li><a href="#testing-settings" id="toc-testing-settings" class="nav-link" data-scroll-target="#testing-settings"><span class="header-section-number">3.1.5</span> Testing Settings</a></li>
  <li><a href="#hypothesis-definitions" id="toc-hypothesis-definitions" class="nav-link" data-scroll-target="#hypothesis-definitions"><span class="header-section-number">3.1.6</span> Hypothesis Definitions</a></li>
  <li><a href="#test-flavour-and-components" id="toc-test-flavour-and-components" class="nav-link" data-scroll-target="#test-flavour-and-components"><span class="header-section-number">3.1.7</span> Test Flavour and Components</a></li>
  <li><a href="#inferential-conclusions" id="toc-inferential-conclusions" class="nav-link" data-scroll-target="#inferential-conclusions"><span class="header-section-number">3.1.8</span> Inferential Conclusions</a></li>
  <li><a href="#how-to-run-the-test-in-r-and-python" id="toc-how-to-run-the-test-in-r-and-python" class="nav-link" data-scroll-target="#how-to-run-the-test-in-r-and-python"><span class="header-section-number">3.1.9</span> How to run the test in <code>R</code> and <code>Python</code>?</a></li>
  <li><a href="#storytelling" id="toc-storytelling" class="nav-link" data-scroll-target="#storytelling"><span class="header-section-number">3.1.10</span> Storytelling</a></li>
  </ul>
</li>
  <li>
<a href="#sec-welch-t-test-ind-samples" id="toc-sec-welch-t-test-ind-samples" class="nav-link" data-scroll-target="#sec-welch-t-test-ind-samples"><span class="header-section-number">3.2</span> Two sample Welch’s t-test for independent samples</a>
  <ul>
<li><a href="#review-1" id="toc-review-1" class="nav-link" data-scroll-target="#review-1"><span class="header-section-number">3.2.1</span> Review</a></li>
  <li><a href="#study-design-1" id="toc-study-design-1" class="nav-link" data-scroll-target="#study-design-1"><span class="header-section-number">3.2.2</span> Study Design</a></li>
  <li><a href="#data-collection-and-wrangling-1" id="toc-data-collection-and-wrangling-1" class="nav-link" data-scroll-target="#data-collection-and-wrangling-1"><span class="header-section-number">3.2.3</span> Data Collection and Wrangling</a></li>
  <li><a href="#explanatory-data-analysis-1" id="toc-explanatory-data-analysis-1" class="nav-link" data-scroll-target="#explanatory-data-analysis-1"><span class="header-section-number">3.2.4</span> Explanatory Data Analysis</a></li>
  <li><a href="#testing-settings-1" id="toc-testing-settings-1" class="nav-link" data-scroll-target="#testing-settings-1"><span class="header-section-number">3.2.5</span> Testing Settings</a></li>
  <li><a href="#hypothesis-definitions-1" id="toc-hypothesis-definitions-1" class="nav-link" data-scroll-target="#hypothesis-definitions-1"><span class="header-section-number">3.2.6</span> Hypothesis Definitions</a></li>
  <li><a href="#test-flavour-and-components-1" id="toc-test-flavour-and-components-1" class="nav-link" data-scroll-target="#test-flavour-and-components-1"><span class="header-section-number">3.2.7</span> Test Flavour and Components</a></li>
  <li><a href="#inferential-conclusions-1" id="toc-inferential-conclusions-1" class="nav-link" data-scroll-target="#inferential-conclusions-1"><span class="header-section-number">3.2.8</span> Inferential Conclusions</a></li>
  <li><a href="#how-to-run-the-test-in-r-and-python-1" id="toc-how-to-run-the-test-in-r-and-python-1" class="nav-link" data-scroll-target="#how-to-run-the-test-in-r-and-python-1"><span class="header-section-number">3.2.9</span> How to run the test in <code>R</code> and <code>Python</code>?</a></li>
  <li><a href="#storytelling-1" id="toc-storytelling-1" class="nav-link" data-scroll-target="#storytelling-1"><span class="header-section-number">3.2.10</span> Storytelling</a></li>
  </ul>
</li>
  <li>
<a href="#sec-z-test-ind-samples" id="toc-sec-z-test-ind-samples" class="nav-link" data-scroll-target="#sec-z-test-ind-samples"><span class="header-section-number">3.3</span> Two sample z-test for Independent Samples</a>
  <ul>
<li><a href="#review-2" id="toc-review-2" class="nav-link" data-scroll-target="#review-2"><span class="header-section-number">3.3.1</span> Review</a></li>
  <li><a href="#study-design-2" id="toc-study-design-2" class="nav-link" data-scroll-target="#study-design-2"><span class="header-section-number">3.3.2</span> Study Design</a></li>
  <li><a href="#data-collection-and-wrangling-2" id="toc-data-collection-and-wrangling-2" class="nav-link" data-scroll-target="#data-collection-and-wrangling-2"><span class="header-section-number">3.3.3</span> Data Collection and Wrangling</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="header-section-number">3.3.4</span> Exploratory Data Analysis</a></li>
  <li><a href="#testing-settings-2" id="toc-testing-settings-2" class="nav-link" data-scroll-target="#testing-settings-2"><span class="header-section-number">3.3.5</span> Testing Settings</a></li>
  <li><a href="#hypothesis-definitions-2" id="toc-hypothesis-definitions-2" class="nav-link" data-scroll-target="#hypothesis-definitions-2"><span class="header-section-number">3.3.6</span> Hypothesis Definitions</a></li>
  <li><a href="#test-flavour-and-components-2" id="toc-test-flavour-and-components-2" class="nav-link" data-scroll-target="#test-flavour-and-components-2"><span class="header-section-number">3.3.7</span> Test Flavour and Components</a></li>
  <li><a href="#inferential-conclusions-2" id="toc-inferential-conclusions-2" class="nav-link" data-scroll-target="#inferential-conclusions-2"><span class="header-section-number">3.3.8</span> Inferential Conclusions</a></li>
  <li><a href="#how-to-run-the-two-sample-z-test-in-r-and-python" id="toc-how-to-run-the-two-sample-z-test-in-r-and-python" class="nav-link" data-scroll-target="#how-to-run-the-two-sample-z-test-in-r-and-python"><span class="header-section-number">3.3.9</span> How to run the two-sample <code>z-test</code> in <code>R</code> and <code>Python</code></a></li>
  <li><a href="#storytelling-2" id="toc-storytelling-2" class="nav-link" data-scroll-target="#storytelling-2"><span class="header-section-number">3.3.10</span> Storytelling</a></li>
  </ul>
</li>
  <li>
<a href="#sec-t-test-paired-samples" id="toc-sec-t-test-paired-samples" class="nav-link" data-scroll-target="#sec-t-test-paired-samples"><span class="header-section-number">3.4</span> Two sample t-test for Paired Samples</a>
  <ul>
<li><a href="#review-3" id="toc-review-3" class="nav-link" data-scroll-target="#review-3"><span class="header-section-number">3.4.1</span> Review</a></li>
  <li><a href="#study-design-3" id="toc-study-design-3" class="nav-link" data-scroll-target="#study-design-3"><span class="header-section-number">3.4.2</span> Study Design</a></li>
  <li><a href="#data-collection-and-wrangling-3" id="toc-data-collection-and-wrangling-3" class="nav-link" data-scroll-target="#data-collection-and-wrangling-3"><span class="header-section-number">3.4.3</span> Data Collection and Wrangling</a></li>
  <li><a href="#exploratory-data-analysis-1" id="toc-exploratory-data-analysis-1" class="nav-link" data-scroll-target="#exploratory-data-analysis-1"><span class="header-section-number">3.4.4</span> Exploratory Data Analysis</a></li>
  <li><a href="#testing-settings-3" id="toc-testing-settings-3" class="nav-link" data-scroll-target="#testing-settings-3"><span class="header-section-number">3.4.5</span> Testing Settings</a></li>
  <li><a href="#hypothesis-definitions-3" id="toc-hypothesis-definitions-3" class="nav-link" data-scroll-target="#hypothesis-definitions-3"><span class="header-section-number">3.4.6</span> Hypothesis Definitions</a></li>
  <li><a href="#test-flavour-and-components-3" id="toc-test-flavour-and-components-3" class="nav-link" data-scroll-target="#test-flavour-and-components-3"><span class="header-section-number">3.4.7</span> Test Flavour and Components</a></li>
  <li><a href="#inferential-conclusions-3" id="toc-inferential-conclusions-3" class="nav-link" data-scroll-target="#inferential-conclusions-3"><span class="header-section-number">3.4.8</span> Inferential Conclusions</a></li>
  <li><a href="#how-to-run-the-two-sample-paired-t-test-in-r-and-python" id="toc-how-to-run-the-two-sample-paired-t-test-in-r-and-python" class="nav-link" data-scroll-target="#how-to-run-the-two-sample-paired-t-test-in-r-and-python"><span class="header-section-number">3.4.9</span> How to run the two-sample paired t-test in <code>R</code> and <code>Python</code></a></li>
  <li><a href="#storytelling-3" id="toc-storytelling-3" class="nav-link" data-scroll-target="#storytelling-3"><span class="header-section-number">3.4.10</span> Storytelling</a></li>
  </ul>
</li>
  <li>
<a href="#tests-for-two-population-proportions" id="toc-tests-for-two-population-proportions" class="nav-link" data-scroll-target="#tests-for-two-population-proportions"><span class="header-section-number">3.5</span> Tests for Two Population Proportions</a>
  <ul>
<li><a href="#review-4" id="toc-review-4" class="nav-link" data-scroll-target="#review-4"><span class="header-section-number">3.5.1</span> Review</a></li>
  <li><a href="#study-design-4" id="toc-study-design-4" class="nav-link" data-scroll-target="#study-design-4"><span class="header-section-number">3.5.2</span> Study Design</a></li>
  <li><a href="#data-collection-and-wrangling-4" id="toc-data-collection-and-wrangling-4" class="nav-link" data-scroll-target="#data-collection-and-wrangling-4"><span class="header-section-number">3.5.3</span> Data Collection and Wrangling</a></li>
  <li><a href="#exploratory-data-analysis-2" id="toc-exploratory-data-analysis-2" class="nav-link" data-scroll-target="#exploratory-data-analysis-2"><span class="header-section-number">3.5.4</span> Exploratory Data Analysis</a></li>
  <li><a href="#testing-settings-4" id="toc-testing-settings-4" class="nav-link" data-scroll-target="#testing-settings-4"><span class="header-section-number">3.5.5</span> Testing Settings</a></li>
  <li><a href="#hypothesis-definitions-4" id="toc-hypothesis-definitions-4" class="nav-link" data-scroll-target="#hypothesis-definitions-4"><span class="header-section-number">3.5.6</span> Hypothesis Definitions</a></li>
  <li><a href="#test-flavour-and-components-4" id="toc-test-flavour-and-components-4" class="nav-link" data-scroll-target="#test-flavour-and-components-4"><span class="header-section-number">3.5.7</span> Test Flavour and Components</a></li>
  <li><a href="#inferential-conclusions-4" id="toc-inferential-conclusions-4" class="nav-link" data-scroll-target="#inferential-conclusions-4"><span class="header-section-number">3.5.8</span> Inferential Conclusions</a></li>
  <li><a href="#how-to-run-the-two-sample-paired-t-test-in-r-and-python-1" id="toc-how-to-run-the-two-sample-paired-t-test-in-r-and-python-1" class="nav-link" data-scroll-target="#how-to-run-the-two-sample-paired-t-test-in-r-and-python-1"><span class="header-section-number">3.5.9</span> How to run the two-sample paired t-test in <code>R</code> and <code>Python</code></a></li>
  <li><a href="#storytelling-4" id="toc-storytelling-4" class="nav-link" data-scroll-target="#storytelling-4"><span class="header-section-number">3.5.10</span> Storytelling</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/pnickchi/test-book/edit/main/book/chapter3-two-pop.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/pnickchi/test-book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/pnickchi/test-book/blob/main/book/chapter3-two-pop.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-two-continuous-means" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tests for Two Continuous Population Mean</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!-- Google tag (gtag.js) --><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DZWGQVJSHE"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DZWGQVJSHE');
</script><div class="LO">
<div class="LO-header">
<p>Learning Objectives</p>
</div>
<div class="LO-container">
<p>By the end of this chapter, you should be able to:</p>
<ul>
<li><p>Formulate hypotheses to compare means or proportions in two population.</p></li>
<li><p>Choose and conduct appropriate two-sample <code>t-tests</code> or two-proportion <code>z-tests</code> based on study context and assumptions.</p></li>
<li><p>Differentiate between independent and paired samples, and choose the appropriate analysis method.</p></li>
<li><p>Perform two-sample and paired <code>t-tests</code> and <code>z-test</code> using both <code>R</code> and <code>Python</code>, and interpret the outputs.</p></li>
<li><p>Apply statistical reasoning to real-world data examples, including evaluating assumptions and limitations.</p></li>
</ul>
</div>
</div>
<p>This chapter introduces statistical tests designed to compare two samples which is a fundamental task in data analysis across many disciplines. Whether you’re comparing average recovery times between two medical treatments, student test scores under different teaching methods, comparing the proportion among two samples, or reaction times under varying stress conditions, these methods help determine whether observed differences are statistically significant or simply due to chance.</p>
<div id="fig-test-chapter-2-mindmap" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-test-chapter-2-mindmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"></figure><p></p>
<div>
<pre class="mermaid mermaid-js">mindmap
  root((Frequentist
  Hypothesis 
  Testings
  ))
    Simulation Based&lt;br/&gt;Tests
    Classical&lt;br/&gt;Tests
      (Chapter 1: &lt;br/&gt;Tests for One&lt;br/&gt;Continuous&lt;br/&gt;Population Mean)
      (Chapter 2: &lt;br/&gt;Tests for Two&lt;br/&gt;Continuous&lt;br/&gt;Population Means)
        Two&lt;br/&gt;Independent&lt;br/&gt;Populations
          {{Unbounded&lt;br/&gt;Responses}}
            Unknown&lt;br/&gt;Population&lt;br/&gt;Variances
              Population&lt;br/&gt;Variances&lt;br/&gt;are assumed&lt;br/&gt;to be Equal
                )Two sample&lt;br/&gt;Student's t test&lt;br/&gt;for Independent&lt;br/&gt;Samples(
              Population&lt;br/&gt;Variances&lt;br/&gt;are assumed&lt;br/&gt;to be Unequal
                )Two sample&lt;br/&gt;Welch's t test&lt;br/&gt;for Independent&lt;br/&gt;Samples(
            Known&lt;br/&gt;Population&lt;br/&gt;Variances
              )Two sample z test&lt;br/&gt;for Independent&lt;br/&gt;Samples(
          {{Proportions between&lt;br/&gt;0 and 1&lt;br/&gt;obtained from two &lt;br/&gt;Binary Responses}}
            )Two sample z test&lt;br/&gt;for Independent&lt;br/&gt;Samples(
        Two&lt;br/&gt;Related&lt;br/&gt;Populations or&lt;br/&gt;Measurements
          {{Unbounded&lt;br/&gt;Responses}}
            )Two sample t test&lt;br/&gt;for Paired&lt;br/&gt;Samples(
      (Chapter 3: &lt;br/&gt;ANOVA-related &lt;br/&gt;Tests for&lt;br/&gt;k Continuous&lt;br/&gt;Population Means)
</pre>
</div>
<p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-test-chapter-2-mindmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: A specific hypothesis testing mind map outlining the techniques explored in this chapter, which are classical tests for two continuous population means.
</figcaption></figure>
</div>
<p>In this chapter, we review tests for comparing two continuous population means under two conditions: when the populations are independent and when they are dependent. Throughout the sections below, we provide details about these tests and required formula for each case. Broadly speaking, there are two main types of tests to compare the means between two continuous populations:</p>
<ul>
<li>Independent samples, where the observations in one group are unrelated to those in the other, and</li>
<li>Paired (or dependent) samples, where observations are naturally matched in some way, such as before-and-after measurements.</li>
</ul>
<p>The choice of test depends on the structure of your data. This chapter introduces both types of comparisons, beginning with independent samples. Each section includes definitions, theoretical background, and R/Python code examples using real or simulated data sets to help ground the concepts in practice. We also review the theoretical background and example codes to test for proportions in two populations.</p>
<section id="sec-t-test-ind-samples" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="sec-t-test-ind-samples">
<span class="header-section-number">3.1</span> Two sample Student’s t-test for Independent Samples</h2>
<section id="review" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="review">
<span class="header-section-number">3.1.1</span> Review</h3>
<p>In this section we talk about two sample student’s t-test for independent samples. Independent samples arise when the observations in one group do not influence or relate to the observations in the other. In statistical terms we call this two independent samples. A classic example from educational research is described below:</p>
<p>Suppose you’re interested in whether a new method of teaching introductory physics improves student performance and learning experience. To investigate this, you decide to test the method at two universities: the University of British Columbia (UBC) and Simon Fraser University (SFU). You apply the new teaching method at SFU and compare the results to students taught with the traditional method at UBC.</p>
<p>In this scenario, students at UBC and SFU form two distinct, unrelated groups. Since the students are not paired or matched across schools, and each individual belongs to only one group, the samples are independent. Note that the samples are drawn from two independent population: students at UBC and SFU, respectively.</p>
<p>Let us assume that each population has an unknown average or mean physics score denoted by:</p>
<p><span class="math display">\[
    \mu_1 \quad \text{(mean for UBC)}, \quad \mu_2 \quad \text{(mean for SFU)}.
\]</span></p>
<p>Since we do not have access to all students’ grades, we take a random sample from each school. Suppose:</p>
<ul>
<li><p>From UBC (Population 1), we obtain a sample of size <span class="math inline">\(n\)</span>, denoted as: <span class="math display">\[x_1, x_2, \ldots, x_n\]</span></p></li>
<li><p>From SFU (Population 2), we obtain a sample of size <span class="math inline">\(m\)</span>, denoted as: <span class="math display">\[y_1, y_2, \ldots, y_m\]</span></p></li>
</ul>
<p>Note that the sample sizes <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> do not necessarily have to be equal. Now, the central question becomes:</p>
<p><strong>Is there a statistically significant difference between the mean physics scores among two groups?</strong></p>
<p>In formal terms, we test the hypotheses:</p>
<p><span class="math display">\[H_0: \mu_1 = \mu_2 \quad \text{versus} \quad H_A: \mu_1 \ne \mu_2\]</span> Now that we reviewed the test concept, let’s try to understand it in a read data set. The steps below follows closely with the roadmap that we introduced in <a href="chapter1-intro.html" class="quarto-xref"><span>Chapter 1</span></a>.</p>
</section><section id="study-design" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="study-design">
<span class="header-section-number">3.1.2</span> Study design</h3>
<p>For this example, we will be using <code>Auto</code> data set from <code>ISLR</code> package. This data set contains gas mileage, horsepower, and other information for 392 vehicles. Some of variables of interest are: 1) <code>cylinders</code> an integer (numerical) value between 4 and 8 which indicates the number of cylinders of car, and 2) <code>horsepower</code> which shows engine horsepower. You may wondering <strong>if the mean of horsepower in cars with 8 cylinders is statistically different than the means in cars with 4 cylinders?</strong></p>
</section><section id="data-collection-and-wrangling" class="level3" data-number="3.1.3"><h3 data-number="3.1.3" class="anchored" data-anchor-id="data-collection-and-wrangling">
<span class="header-section-number">3.1.3</span> Data Collection and Wrangling</h3>
<p>To answer this question, we obtain the data set which is available in <code>ISLR</code> package. Note that we consider this data a random sample from population of cars. First we create a new copy of this data set to avoid touching the actual data (this is optional). Also we filter rows to those cars with 4 or 8 cylinders only.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get a copy of data set</span></span>
<span><span class="va">auto_data</span> <span class="op">&lt;-</span> <span class="va">Auto</span></span>
<span></span>
<span><span class="co"># Filter rows to cars with 4 or 8 cylinders</span></span>
<span><span class="va">auto_data</span> <span class="op">&lt;-</span> <span class="va">auto_data</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">8</span><span class="op">)</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we randomly create training and test sets from this dataset, using a 50–50 split. It is important to ensure that the proportion of cars with 4 and 8 cylinders remains similar across the two sets; otherwise, the imbalance could introduce bias into our analysis. The <code>initial_split</code>, <code>training</code>, and <code>testing</code> functions from the <code>rsample</code> package are very helpful for handling this correctly.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Randomly splitting into training and testing sets by number of car cylinders</span></span>
<span><span class="va">auto_data_splitting</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">auto_data</span>, prop <span class="op">=</span> <span class="fl">0.5</span>, strata <span class="op">=</span> <span class="va">cylinders</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assigning data points to training and testing sets</span></span>
<span><span class="va">train_auto</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">auto_data_splitting</span><span class="op">)</span></span>
<span><span class="va">test_auto</span>  <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">auto_data_splitting</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sanity check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Training shape:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">train_auto</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training shape: 150 9 </code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Testing shape:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">test_auto</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing shape: 152 9 </code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Training proportions:\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training proportions:</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">train_auto</span><span class="op">$</span><span class="va">cylinders</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   4    8 
0.66 0.34 </code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nTesting proportions:\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Testing proportions:</code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">test_auto</span><span class="op">$</span><span class="va">cylinders</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        4         8 
0.6578947 0.3421053 </code></pre>
</div>
</div>
</section><section id="explanatory-data-analysis" class="level3" data-number="3.1.4"><h3 data-number="3.1.4" class="anchored" data-anchor-id="explanatory-data-analysis">
<span class="header-section-number">3.1.4</span> Explanatory Data Analysis</h3>
<p>Once we have the data and it is split into training and test sets, the next step is to begin exploratory data analysis (EDA) on train set. This step is crucial, as it helps us gain a better understanding of the distribution of variables in our data set. The <code>horsepower</code> variable in data set is a numerical variable. The <code>cylinders</code> variable is an integer variable that helps to divide observations into two groups.</p>
<p>In particular, we are interested in the distribution of <code>horsepower</code> in two different groups (cars with 4 cylinders vs cars with 8 cylinders). Using a histogram for this variable is a good choice as we have a variable with numerical values.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-histogram-horspower-by-cylinders" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histogram-horspower-by-cylinders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter3-two-pop_files/figure-html/fig-histogram-horspower-by-cylinders-1.png" class="img-fluid figure-img" width="1344">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histogram-horspower-by-cylinders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Histogram of horsepower by number of cylinders for train data.
</figcaption></figure>
</div>
</div>
</div>
<p>We also look at some descriptive statistics of horsepower in both groups for better understanding of data. The descriptive statistics in cars with 4 cylinders:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">train_auto</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">select</span><span class="op">(</span><span class="va">horsepower</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   horsepower    
 Min.   : 46.00  
 1st Qu.: 68.00  
 Median : 80.00  
 Mean   : 79.22  
 3rd Qu.: 90.00  
 Max.   :113.00  </code></pre>
</div>
</div>
<p>and with 8 cylinders:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">train_auto</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">select</span><span class="op">(</span><span class="va">horsepower</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   horsepower   
 Min.   :105.0  
 1st Qu.:140.0  
 Median :150.0  
 Mean   :157.5  
 3rd Qu.:172.5  
 Max.   :230.0  </code></pre>
</div>
</div>
<p>Looking at summary statistics, there is a bit of overlap between distribution of <code>horsepower</code> among two groups but it does not seem to be much. In fact they seem to be quite separated. Also there is a clear difference in their mean and the following plot also confirms this:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-density-plot-horspower-by-cylinders" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-density-plot-horspower-by-cylinders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter3-two-pop_files/figure-html/fig-density-plot-horspower-by-cylinders-1.png" class="img-fluid figure-img" width="1344">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-density-plot-horspower-by-cylinders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Density plot of horsepower by number of cylinders.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="testing-settings" class="level3" data-number="3.1.5"><h3 data-number="3.1.5" class="anchored" data-anchor-id="testing-settings">
<span class="header-section-number">3.1.5</span> Testing Settings</h3>
<p>We use a significant level of <span class="math inline">\(\alpha = 0.05\)</span> to run the test. Considering the data we have is a sample from a population of cars we have the following:</p>
<ul>
<li>
<span class="math inline">\(\mu_{1}\)</span> is the mean of horsepower for cars with 4 cylinders in the population.</li>
<li>
<span class="math inline">\(\mu_{2}\)</span> is the mean of horsepower for cars with 8 cylinders in the population.</li>
</ul></section><section id="hypothesis-definitions" class="level3" data-number="3.1.6"><h3 data-number="3.1.6" class="anchored" data-anchor-id="hypothesis-definitions">
<span class="header-section-number">3.1.6</span> Hypothesis Definitions</h3>
<p>We now define the null and alternative hypothesis. Recall the main inquiry we had:</p>
<p><strong>You may wondering if the average of horsepower in cars with 4 cylinders is statistically different than the means in cars with 8 cylinders?</strong></p>
<p>This translates into the following null and alternative hypotheses:</p>
<p><span class="math display">\[H_0: \mu_{1} = \mu_{2} \quad vs \quad H_a: \mu_{1} \neq \mu_{2}\]</span></p>
<p>Note that the alternative hypothesis is two-sided, as our question does not favor either group and only asks whether the means are different (i.e., group one could be less than or greater than group two). Also the hypothesis tests the unknown parameters in the population which are <span class="math inline">\(\mu_{1}\)</span> and <span class="math inline">\(\mu_{2}\)</span>.</p>
</section><section id="test-flavour-and-components" class="level3" data-number="3.1.7"><h3 data-number="3.1.7" class="anchored" data-anchor-id="test-flavour-and-components">
<span class="header-section-number">3.1.7</span> Test Flavour and Components</h3>
<p>To test this hypothesis, we use the <strong>two-sample student’s t-test for independent samples</strong>, which compares the sample means and incorporates variability within and between the samples. Note that in this case the samples are independent as clearly cars with 4 cylinders are independent from cars with 8 cylinders.</p>
<p>Now we need to compute a test statistic from the sample. Assuming equal population variances, the test statistic is:</p>
<p><span id="eq-t-statistic-equal-var"><span class="math display">\[t = \frac{(\bar{x} - \bar{y})}{ \sqrt{ s^{2}_p (\frac{1}{n} + \frac{1}{m}})} \tag{3.1}\]</span></span> where:</p>
<ul>
<li>
<span class="math inline">\(\bar{x}\)</span> is the mean of horsepower for cars with 4 cylinders in the sample</li>
<li>
<span class="math inline">\(\bar{y}\)</span> is the mean of horsepower for cars with 8 cylinders in the sample</li>
<li>
<span class="math inline">\(s^{2}_p\)</span> is the <span class="math inline">\(\textbf{pooled sample variane}\)</span> and is computed as: <span id="eq-pooled-sample-variance"><span class="math display">\[s^{2}_p = \frac{(n - 1)s_x^2 + (m - 1)s_y^2}{n + m - 2} \tag{3.2}\]</span></span>
</li>
<li>
<span class="math inline">\(s_x^2\)</span> and <span class="math inline">\(s_y^2\)</span> are the sample variances of the two groups.</li>
</ul>
<p><br></p>
<div class="Heads-up">
<div class="Heads-up-header">
<p>Heads-up!</p>
</div>
<div class="Heads-up-container">
<ul>
<li><p>Note that all elements in <a href="#eq-t-statistic-equal-var" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> which is our statistic are computed based on sample.</p></li>
<li><p>You can think of pooled sample variance defined in <a href="#eq-pooled-sample-variance" class="quarto-xref">Equation&nbsp;<span>3.2</span></a> as a weighted average of sample variances of <span class="math inline">\(s_x^2\)</span> and <span class="math inline">\(s_y^2\)</span>.</p></li>
<li><p><strong>Why it is a weighted average?</strong></p></li>
<li><p>The <strong>weights</strong> are <span class="math inline">\(\frac{(n - 1)}{n + m - 2}\)</span> and <span class="math inline">\(\frac{(m - 1)}{n + m - 2}\)</span>. These weights reflect how much <em>information</em> each sample’s variance provides — larger samples get more weight. You can see it better if you write it explicitly:</p></li>
</ul>
<p><span class="math display">\[
S_p^{2}
= \frac{(n - 1)}{n + m - 2} \, s_x^2 + \frac{(m - 1)}{n + m - 2} \, s_y^2
\]</span></p>
<ul>
<li>You can see it is literally a weighted mean where weights sum to one:</li>
</ul>
<p><span class="math display">\[
\frac{n-1}{n+m-2} + \frac{m-1}{n+m-2} = 1
\]</span></p>
</div>
</div>
<p><br></p>
<div class="Tip">
<div class="Tip-header">
<p>Tip: Equal variance assumption!</p>
</div>
<div class="Tip-container">
<ul>
<li><p>The assumption in this test is that variances among two groups in the population are equal meaning that if we look at the random variable of horsepower in both populations, the variance of this random variable is roughly equal in two groups (cars with 4 cylinders and cars with 8 cylinders).</p></li>
<li><p>Note that we do not have access to population and this is rather an assumption that we make with consultation with experts or justifying it based on previous studies. We will introduce the test without equal variance assumption in the next section.</p></li>
<li><p>There are some statistical methods designed to test if the variances of different groups are the same or not. In fact they can be used to test the equal assumption of variances of groups in the population. Similar to any hypothesis testing, these tests work on a random sample from the population to run the test. Some of the tests are <em>F-test for Equality of Variances</em>, <em>Levene’s Test</em>, and <em>Bartlett’s Test</em>.</p></li>
<li><p>Describing these tests is not the focus of this book. You can read more about them HERE/LINK</p></li>
</ul>
</div>
</div>
</section><section id="inferential-conclusions" class="level3" data-number="3.1.8"><h3 data-number="3.1.8" class="anchored" data-anchor-id="inferential-conclusions">
<span class="header-section-number">3.1.8</span> Inferential Conclusions</h3>
<p>As you can see, the test statistic defined in <a href="#eq-t-statistic-equal-var" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> computes the difference between <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> and scale it based on the standard deviation of this difference. Now the question is whether this difference is significant or not? In order to answer this question we need to know the behavior of statistic that we defined in <a href="#eq-t-statistic-equal-var" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> (and denoted by <span class="math inline">\(t\)</span>) and have a better understanding of what are typical values of this statistic.</p>
<p><br></p>
<div class="Heads-up">
<div class="Heads-up-header">
<p>Heads-up!</p>
</div>
<div class="Heads-up-container">
<p>Note that <span class="math inline">\(t\)</span> itself is a random variable as it would change from sample to sample.</p>
</div>
</div>
<p><br></p>
<p>Knowing the distribution of this statistic helps us to compute <span class="math inline">\(\textit{p-value}\)</span> of the test as follows:</p>
<p><span class="math display">\[\textit{p-value} = 2 \times Pr(T_{(n+m-2)} \ge |t|)\]</span></p>
<p>Looking at the formula, we can see that we are essentially calculating how much is it likely to see an observation as big as <span class="math inline">\(t\)</span> or as extreme as <span class="math inline">\(t\)</span> (which we computed from our sample) under a t-distribution with a certain degrees of freedom (df) which we are denoting by <span class="math inline">\(T_{(n+m-2)}\)</span>.</p>
<p><br></p>
<div class="Tip">
<div class="Tip-header">
<p>Tip:</p>
</div>
<div class="Tip-container">
<ul>
<li><p>We skipped the theory behind it but under the assumption that null hypothesis is correct (i.e.&nbsp;<span class="math inline">\(\mu_1=\mu_2\)</span>) then the test statistic defined in <a href="#eq-t-statistic-equal-var" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> (<span class="math inline">\(t\)</span>) follows a t-distribution with <span class="math inline">\(n + m -2\)</span> degrees of freedom. We denoted this distribution by <span class="math inline">\(T_{(n+m-2)}\)</span>.</p></li>
<li><p><strong>Note:</strong> The probability is multiplied by two since we have a two sided hypothesis (alternative is <span class="math inline">\(\mu_1 \neq \mu_2\)</span>). For a one sided test (when alternative hypothesis is <span class="math inline">\(\mu_1 &gt; \mu_2\)</span> or <span class="math inline">\(\mu_1 &lt; \mu_2\)</span>) we do not need to multiply by two.</p></li>
<li><p>Now we compare the <span class="math inline">\(\textit{p-value}\)</span> to our significance level. If the <span class="math inline">\(\textit{p-value}\)</span> is less than the significance level, then we have evidence against the null hypothesis. The reasoning is as follows: we performed the calculation under the assumption that the null hypothesis is true. If the null hypothesis is true, then the test statistic we computed should follow a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n + m - 2\)</span> degrees of freedom. If the p-value is smaller than our chosen significance level, this means it is unlikely that our observed result comes from a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n + m - 2\)</span> degrees of freedom. In other words, it is unlikely that our initial assumption about the null hypothesis is correct.</p></li>
</ul>
</div>
</div>
<p><br></p>
<p>Note that our observation from the sample might still lead us to an incorrect conclusion (since there is variability among samples). Our tolerance for this type of error is determined by the significance level. If <span class="math inline">\(\textit{p-value}\)</span> <strong>is not less than</strong> significant level then we do not have any evidence to reject the null hypothesis. Otherwise (if <span class="math inline">\(\textit{p-value}\)</span> <strong>is less than</strong> significant level) we do have evidence against the null hypothesis</p>
<p>Now let us see how to run the two-sample test in <code>R</code> and <code>Python</code>. Note that we already used train data for EDA purposes. For the purpose of hypothesis testing now we use test data to avoid double dipping.</p>
</section><section id="how-to-run-the-test-in-r-and-python" class="level3" data-number="3.1.9"><h3 data-number="3.1.9" class="anchored" data-anchor-id="how-to-run-the-test-in-r-and-python">
<span class="header-section-number">3.1.9</span> How to run the test in <code>R</code> and <code>Python</code>?</h3>
<p>The following lines of code in tabset show you how to run the test in <code>R</code> or <code>Python</code>. Note that generally there are two ways of running this test in <code>R</code> as shown below (there might be other ways but we focus on these two for now). They both give the same result and you are welcome to use either of them. Here is a quick explanation from a coding perspective:</p>
<ul>
<li><p>In <strong>Option 1</strong>, we first select the cars with 4 or 8 cylinders and save each of them in a vector (<code>cylinders_4</code> and <code>cylinders_8</code>). We then use <code>t.test</code> function to run the test. Note that we pass them as <code>x = cylinders_4</code> for first group and <code>y = cylinders_8</code> for the second group.</p></li>
<li><p>In <strong>Option 2</strong>, we use a formula to tell <code>R</code> what is the variable that records the outcome of interest (in this example <code>horsepower</code> variable) and what is the grouping variable (in this example <code>cylinders</code>). This approach is more concise and easier to read, especially when working directly with a data frame. Note that we need to let <code>R</code> know where it can find <code>horsepower</code> and <code>cylinders</code> which we do by setting <code>data = test_auto</code>. Using <code>horsepower ~ cylinders</code> essentially tells <code>R</code> that my varriable of interest for <code>t.test</code> is in <code>horsepower</code> and the grouping variable (4 or 8 cylinders) is in <code>cylinders</code>. Note that the order matters and you can not write it as <code>cylinders ~ horsepower</code>.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R Code - Option 1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">R Code - Option 2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a vector to hold horsepower values for cars with 4 cylinders</span></span>
<span><span class="va">cylinders_4</span> <span class="op">&lt;-</span> <span class="va">test_auto</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">select</span><span class="op">(</span><span class="va">horsepower</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a vector to hold horsepower values for cars with 8 cylinders</span></span>
<span><span class="va">cylinders_8</span> <span class="op">&lt;-</span> <span class="va">test_auto</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">select</span><span class="op">(</span><span class="va">horsepower</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cylinders_4</span>, y <span class="op">=</span> <span class="va">cylinders_8</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  cylinders_4 and cylinders_8
t = -23.603, df = 150, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -88.56874 -74.88510
sample estimates:
mean of x mean of y 
  77.3500  159.0769 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Use the formula horsepower ~ cylinders to run the test </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">horsepower</span> <span class="op">~</span> <span class="va">cylinders</span>, data <span class="op">=</span> <span class="va">test_auto</span>, var.equal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  horsepower by cylinders
t = -23.603, df = 150, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group 4 and group 8 is not equal to 0
95 percent confidence interval:
 -88.56874 -74.88510
sample estimates:
mean in group 4 mean in group 8 
        77.3500        159.0769 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read test_auto dataframe in Python as df dataframe</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/test_auto.csv'</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Select cars with 4 and 8 cylinders</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>cylinders_4 <span class="op">=</span> df[df[<span class="st">"cylinders"</span>] <span class="op">==</span> <span class="dv">4</span>][<span class="st">"horsepower"</span>]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>cylinders_8 <span class="op">=</span> df[df[<span class="st">"cylinders"</span>] <span class="op">==</span> <span class="dv">8</span>][<span class="st">"horsepower"</span>]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the test</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>t_stat, p_val <span class="op">=</span> stats.ttest_ind(cylinders_4, cylinders_8, equal_var <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print t statistic value</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"T-statistic: </span><span class="sc">{</span>t_stat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>T-statistic: -23.6025949975427</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-value of the test</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"P-value: </span><span class="sc">{</span>p_val<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 2.2949229038881686e-52</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><strong>Details about <code>R</code> code and output</strong></p>
<p>In order to run this test in <code>R</code>, similar to what we learned in <a href="chapter2-one-pop.html" class="quarto-xref"><span>Chapter 2</span></a> we can use <code>t.test</code> function in R. The function can be used to perform one or two sample t-tests. The relevant arguments of the function are as follows:</p>
<ul>
<li>
<code>x</code> is (non-empty) numeric vector of data values.</li>
<li>
<code>y</code> is also (non-empty) numeric vector of data values (can be <code>NULL</code> if you run a one sample test).</li>
<li>
<code>var.equal</code> is a binary value (TRUE/FALSE) to indicate if <code>R</code> needs to assume equal variance between population of two groups or not. By default the value of <code>var.equal</code> is <code>FALSE</code>. We manually set it to <code>TRUE</code> to implement equal variance assumption in our test.</li>
</ul>
<p>Using <em>Option 1</em> or <em>Option 2</em> for <code>R</code>, in both outputs we can see the following elements:</p>
<ul>
<li><p><code>t</code> is the test statistic defined in <a href="#eq-t-statistic-equal-var" class="quarto-xref">Equation&nbsp;<span>3.1</span></a></p></li>
<li><p><code>df</code> is the degrees of freedom for the test. You can manually calculate and confirm/see that it equals <span class="math inline">\(n+m-2\)</span>.</p></li>
<li><p><code>p-value</code> is the <span class="math inline">\(\textit{p-value}\)</span> of the test. Note that, by default, this is for a two-sided test. If you need to conduct a one-sided test, you can either divide the p-value by two or use the <code>alternative</code> argument in the <code>t.test</code> function. You can read more about it in help documentation of <code>t.test</code> function (type and run help(t.test) in <code>R</code> console and look for <code>alternative</code> argument.)</p></li>
<li><p><code>95 percent confidence interval</code> provides the 95% confidence interval for the parameter of <span class="math inline">\(\mu_1 - \mu_2\)</span>. You can control the level of your confidence interval by setting <code>conf.level</code> to other values between 0 and 1. By default it is set to <code>conf.level = 0.95</code>.</p></li>
<li><p><code>sample estimates</code> gives the sample means for each group, i.e.&nbsp;<span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span>.</p></li>
</ul>
<p><strong>Details about <code>Python</code> code and output</strong></p>
<p>In this example, we perform the test in <code>Python</code>. We use <code>pandas</code> package to read data in <code>Python</code> and <code>scipy</code> for running the test. Here is a breakdown of key points:</p>
<ul>
<li><p><code>cylinders_4</code> and <code>cylinders_8</code> are <code>pandas</code> objects containing the horsepower values for cars with 4 and 8 cylinders, respectively.</p></li>
<li><p>The function <code>ttest_ind</code> from <code>stats</code> module computes the <code>t-test</code> for the means of two independent samples.</p></li>
<li><p>The argument <code>equal_var=True</code> tells <code>Python</code> to assume equal population variances (similar to setting <code>var.equal = TRUE</code> in <code>t.test</code> function <code>R</code>).</p></li>
<li><p>The function returns two values: <code>t_stat</code> which is the computed t-statistic and <code>p_val</code> which is the <span class="math inline">\(\textit{p-value}\)</span> of the test. By default, <code>ttest_ind</code> performs a two-sided test. For a one-sided test, you would need to adjust the <span class="math inline">\(\textit{p-value}\)</span> accordingly (e.g., divide by two if the t-statistic is in the direction of interest).</p></li>
<li><p>This <code>Python</code> approach is directly comparable to using <code>t.test</code> in <code>R</code>, with the main conceptual difference being how arguments are named and handled.</p></li>
</ul></section><section id="storytelling" class="level3" data-number="3.1.10"><h3 data-number="3.1.10" class="anchored" data-anchor-id="storytelling">
<span class="header-section-number">3.1.10</span> Storytelling</h3>
<p>Finally, based on the sample we have and the analysis we conducted, we can draw a conclusion about our initial question: <strong>Is the mean horsepower of cars with 8 cylinders statistically different from that of cars with 4 cylinders?</strong></p>
<p>We observed that the <span class="math inline">\(p-\textit{value}\)</span> of the test was extremely small compared to the significance level <span class="math inline">\(\alpha = 0.05\)</span>. This provides strong evidence against the null hypothesis. In simple terms, this means: <em>There is a meaningful difference in the average horsepower between cars with 4 cylinders and those with 8 cylinders.</em></p>
<p>So, if you are shopping for a car with more horsepower, it looks like going for one with 8 cylinders might be the way to go as you get a significant boost in powerhorse — assuming you don’t mind the extra fuel costs of course!!</p>
</section></section><section id="sec-welch-t-test-ind-samples" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="sec-welch-t-test-ind-samples">
<span class="header-section-number">3.2</span> Two sample Welch’s t-test for independent samples</h2>
<section id="review-1" class="level3" data-number="3.2.1"><h3 data-number="3.2.1" class="anchored" data-anchor-id="review-1">
<span class="header-section-number">3.2.1</span> Review</h3>
<p>In this section, we discuss the two-sample Welch’s t-test for independent samples. This test is similar to the two-sample Student’s t-test we described earlier in <a href="#sec-t-test-ind-samples" class="quarto-xref">Section&nbsp;<span>3.1</span></a>, with one important difference: it <strong>does not</strong> assume equal variances between the two groups. We use the Welch’s t-test when we have no reason or evidence to believe that the variable of interest has the same variance in both population groups.</p>
</section><section id="study-design-1" class="level3" data-number="3.2.2"><h3 data-number="3.2.2" class="anchored" data-anchor-id="study-design-1">
<span class="header-section-number">3.2.2</span> Study Design</h3>
<p>We will be using <code>Auto</code> data set from <code>ISLR</code> package in this section too. Now the main statistical question of interest remains the same as before: <strong>You may wondering if the mean of horsepower in cars with 8 cylinders is statistically different than the means in cars with 4 cylinders?</strong> but we do <strong>not</strong> make an equal variance assumption anymore.</p>
<p>In this context, unequal variances mean that the spread or variability of horsepower values could differ between the two groups, so we allow each group to have its own variance estimate. Now we are applying a two sample Welch’s t-test for independent samples.</p>
</section><section id="data-collection-and-wrangling-1" class="level3" data-number="3.2.3"><h3 data-number="3.2.3" class="anchored" data-anchor-id="data-collection-and-wrangling-1">
<span class="header-section-number">3.2.3</span> Data Collection and Wrangling</h3>
<p>To answer the question, we obtain the data set which is available in <code>ISLR</code> package. The following codes are exactly the same as described in <code>Data Collection and Wrangling</code> of <a href="#sec-t-test-ind-samples" class="quarto-xref"><span>Section 3.1</span></a> and are shown here as a review. Essentially the data sets (train and test) that we use in this section are the same as previous example.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get a copy of data set</span></span>
<span><span class="va">auto_data</span> <span class="op">&lt;-</span> <span class="va">Auto</span></span>
<span></span>
<span><span class="co"># Filter rows to cars with 4 or 8 cylinders</span></span>
<span><span class="va">auto_data</span> <span class="op">&lt;-</span> <span class="va">auto_data</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">8</span><span class="op">)</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Randomly splitting into training and testing sets by number of car cylinders</span></span>
<span><span class="va">auto_data_splitting</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">auto_data</span>, prop <span class="op">=</span> <span class="fl">0.5</span>, strata <span class="op">=</span> <span class="va">cylinders</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assigning data points to training and testing sets</span></span>
<span><span class="va">train_auto</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">auto_data_splitting</span><span class="op">)</span></span>
<span><span class="va">test_auto</span>  <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">auto_data_splitting</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sanity check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Training shape:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">train_auto</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Testing shape:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">test_auto</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Training proportions:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">train_auto</span><span class="op">$</span><span class="va">cylinders</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nTesting proportions:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">test_auto</span><span class="op">$</span><span class="va">cylinders</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="explanatory-data-analysis-1" class="level3" data-number="3.2.4"><h3 data-number="3.2.4" class="anchored" data-anchor-id="explanatory-data-analysis-1">
<span class="header-section-number">3.2.4</span> Explanatory Data Analysis</h3>
<p>Once we have the data and it is split into training and test sets, the next step is to begin exploratory data analysis (EDA) on train set. Recall that the <code>cylinders</code> variable is an integer variable that helps to divide observations into two groups.</p>
<p>We are still interested in the distribution of <code>horsepower</code> in two different groups (cars with 4 cylinders vs cars with 8 cylinders). Using a histogram for this variable is a good choice as we have a variable with numerical values. The following plot is the same as before and we are showing it here as a review.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-histogram-horspower-by-cylinders-v2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histogram-horspower-by-cylinders-v2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter3-two-pop_files/figure-html/fig-histogram-horspower-by-cylinders-v2-1.png" class="img-fluid figure-img" width="1344">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histogram-horspower-by-cylinders-v2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Histogram of horsepower by number of cylinders for train data.
</figcaption></figure>
</div>
</div>
</div>
<p>The descriptive statistics in cars with 4 cylinders:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">train_auto</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">select</span><span class="op">(</span><span class="va">horsepower</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   horsepower    
 Min.   : 46.00  
 1st Qu.: 68.00  
 Median : 80.00  
 Mean   : 79.22  
 3rd Qu.: 90.00  
 Max.   :113.00  </code></pre>
</div>
</div>
<p>and with 8 cylinders:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">train_auto</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">select</span><span class="op">(</span><span class="va">horsepower</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   horsepower   
 Min.   :105.0  
 1st Qu.:140.0  
 Median :150.0  
 Mean   :157.5  
 3rd Qu.:172.5  
 Max.   :230.0  </code></pre>
</div>
</div>
<p>Our conclusion remains the same. Looking at summary statistics, there is a bit of overlap between distribution of <code>horsepower</code> among two groups but it does not seem to be much. In fact they seem to be quite separated. Also there is a clear difference in their mean and the following plot also confirms this:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-density-plot-horspower-by-cylinders-v2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-density-plot-horspower-by-cylinders-v2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter3-two-pop_files/figure-html/fig-density-plot-horspower-by-cylinders-v2-1.png" class="img-fluid figure-img" width="1344">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-density-plot-horspower-by-cylinders-v2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Density plot of horsepower by number of cylinders.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="testing-settings-1" class="level3" data-number="3.2.5"><h3 data-number="3.2.5" class="anchored" data-anchor-id="testing-settings-1">
<span class="header-section-number">3.2.5</span> Testing Settings</h3>
<p>We use a significant level of <span class="math inline">\(\alpha = 0.05\)</span> to run the test. Considering the data we have is a sample from a population of cars we have the following parameters of interset in our population:</p>
<ul>
<li>
<span class="math inline">\(\mu_{1}\)</span> is the mean of horsepower for cars with 4 cylinders in the population.</li>
<li>
<span class="math inline">\(\mu_{2}\)</span> is the mean of horsepower for cars with 8 cylinders in the population.</li>
</ul></section><section id="hypothesis-definitions-1" class="level3" data-number="3.2.6"><h3 data-number="3.2.6" class="anchored" data-anchor-id="hypothesis-definitions-1">
<span class="header-section-number">3.2.6</span> Hypothesis Definitions</h3>
<p>We now define the null and alternative hypothesis. Recall the main inquiry we had:</p>
<p><strong>You may wondering if the average of horsepower in cars with 4 cylinders is statistically different than the means in cars with 8 cylinders?</strong></p>
<p>This translates into the following null and alternative hypotheses:</p>
<p><span class="math display">\[H_0: \mu_{1} = \mu_{2} \quad vs \quad H_a: \mu_{1} \neq \mu_{2}\]</span></p>
<p>Note that the alternative hypothesis is two-sided, as our question does not favor either group and only asks whether the means are different (i.e., group one could be less than or greater than group two). Also the hypothesis tests the unknown parameters in the population which are <span class="math inline">\(\mu_{1}\)</span> and <span class="math inline">\(\mu_{2}\)</span>.</p>
</section><section id="test-flavour-and-components-1" class="level3" data-number="3.2.7"><h3 data-number="3.2.7" class="anchored" data-anchor-id="test-flavour-and-components-1">
<span class="header-section-number">3.2.7</span> Test Flavour and Components</h3>
<p>As noted before we use Welch’s t-test if the assumption of equal variances is questionable. This test adjusts the standard error and degrees of freedom (<code>df</code>) of the test accordingly. As a result the test statistic and <code>df</code> of the test are different than what we described in <a href="#sec-t-test-ind-samples" class="quarto-xref">Section&nbsp;<span>3.1</span></a>. The Welch’s test statistic is computed as:</p>
<p><span id="eq-t-statistic-unequal-var"><span class="math display">\[t = \frac{\bar{x} - \bar{y}}{\sqrt{\frac{s_x^2}{n} + \frac{s_y^2}{m}}} \tag{3.3}\]</span></span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\bar{x}\)</span> is the mean of horsepower for cars with 4 cylinders in the sample</li>
<li>
<span class="math inline">\(\bar{y}\)</span> is the mean of horsepower for cars with 8 cylinders in the sample</li>
<li>
<span class="math inline">\(s_x^2\)</span> and <span class="math inline">\(s_y^2\)</span> are the sample variances of the two groups.</li>
<li>
<span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> are the sample sizes in two groups (not necessarily the same).</li>
</ul>
<div class="Heads-up">
<div class="Heads-up-header">
<p>Quick review!</p>
</div>
<div class="Heads-up-container">
<ul>
<li>Note that, as before, all elements in <a href="#eq-t-statistic-unequal-var" class="quarto-xref">Equation&nbsp;<span>3.3</span></a> (statistic) are computed based on the sample.</li>
<li>Additionally, the assumption of unequal variance between two populations can be tested using a variety of statistical tests.</li>
<li>We do not discuss these tests in this book as the focus of this book lies elsewhere. If you are interested to read more about it, refer to REF.</li>
</ul>
</div>
</div>
</section><section id="inferential-conclusions-1" class="level3" data-number="3.2.8"><h3 data-number="3.2.8" class="anchored" data-anchor-id="inferential-conclusions-1">
<span class="header-section-number">3.2.8</span> Inferential Conclusions</h3>
<p>As you can see, the test statistic in <a href="#eq-t-statistic-unequal-var" class="quarto-xref">Equation&nbsp;<span>3.3</span></a> computes the difference between averages of two samples and adjusts it based on the standard deviation of their differences. The only change from Student’s t-test is the standard deviation that is being used in the denominator. Again the question is whether this difference is significant or not?</p>
<p>In order to answer this question we need to know the behavior of statistic that we defined in <a href="#eq-t-statistic-unequal-var" class="quarto-xref">Equation&nbsp;<span>3.3</span></a> and have a better understanding of what are typical values of this statistic. Knowing the distribution of this statistic helps us to compute the <span class="math inline">\(\textit{p-value}\)</span> of the test as follows:</p>
<p><span class="math display">\[\textit{p-value} = 2 \times Pr(T_{\nu} \ge |t|)\]</span></p>
<div class="Tip">
<div class="Tip-header">
<p>Tip on degrees of freedom!</p>
</div>
<div class="Tip-container">
<ul>
<li><p>We skipped the theory behind it but under the assumption that null hypothesis is correct, it can be shown that the test statistic defined in <a href="#eq-t-statistic-unequal-var" class="quarto-xref">Equation&nbsp;<span>3.3</span></a> still follows a t-distribution but with a different degrees of freedom (<code>df</code>).</p></li>
<li><p>Note that this degree of freedom is not necessarily an integer number (could be a real number).</p></li>
<li><p>The Greek sign <span class="math inline">\(\nu\)</span> is used here to show the degree of freedom of t-distribution shown in <span class="math inline">\(T_{\nu}\)</span>.</p></li>
<li><p>The degree of freedom is computed as</p></li>
</ul>
<p><span class="math display">\[\nu = \frac{\left( \frac{s_x^2}{n} + \frac{s_y^2}{m} \right)^2}
{\frac{\left( \frac{s_x^2}{n} \right)^2}{n - 1} + \frac{\left( \frac{s_y^2}{m} \right)^2}{m - 1}}\]</span></p>
</div>
</div>
</section><section id="how-to-run-the-test-in-r-and-python-1" class="level3" data-number="3.2.9"><h3 data-number="3.2.9" class="anchored" data-anchor-id="how-to-run-the-test-in-r-and-python-1">
<span class="header-section-number">3.2.9</span> How to run the test in <code>R</code> and <code>Python</code>?</h3>
<p>The following lines of code in tabset show you how to run the Welch’s test in <code>R</code> or <code>Python</code>.</p>
<div class="Heads-up">
<div class="Heads-up-header">
<p>A quick reminder!</p>
</div>
<div class="Heads-up-container">
<ul>
<li><p>In <strong>Option 1</strong>, we first select the cars with 4 or 8 cylinders and save them in a vector (<code>cylinders_4</code> and <code>cylinders_8</code>). We then use <code>t.test</code> function to run the test.</p></li>
<li><p>In <strong>Option 2</strong>, we use a formula to tell <code>R</code> what is the variable that records the outcome of interest (in this example <code>horsepower</code> variable) and what is the grouping variable (in this example <code>cylinders</code>).</p></li>
<li><p>Using <strong>Option 2</strong> is more concise and easier to read, especially when working directly with a data frame.</p></li>
<li><p>Note that we need to let <code>R</code> know where it can find <code>horsepower</code> and <code>cylinders</code> which we do by setting <code>data = test_auto</code>.</p></li>
</ul>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R Code - Option 1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">R Code - Option 2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a vector to hold horsepower values for cars with 4 cylinders</span></span>
<span><span class="va">cylinders_4</span> <span class="op">&lt;-</span> <span class="va">test_auto</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">horsepower</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a vector to hold horsepower values for cars with 8 cylinders</span></span>
<span><span class="va">cylinders_8</span> <span class="op">&lt;-</span> <span class="va">test_auto</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">cylinders</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">horsepower</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cylinders_4</span>, y <span class="op">=</span> <span class="va">cylinders_8</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  cylinders_4 and cylinders_8
t = -19.37, df = 64.007, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -90.15599 -73.29786
sample estimates:
mean of x mean of y 
  77.3500  159.0769 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Use the formula horsepower ~ cylinders to run the test </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">horsepower</span> <span class="op">~</span> <span class="va">cylinders</span>, data <span class="op">=</span> <span class="va">test_auto</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  horsepower by cylinders
t = -19.37, df = 64.007, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group 4 and group 8 is not equal to 0
95 percent confidence interval:
 -90.15599 -73.29786
sample estimates:
mean in group 4 mean in group 8 
        77.3500        159.0769 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read test_auto dataframe in Python as df dataframe</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/test_auto.csv'</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Select cars with 4 and 8 cylinders</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>cylinders_4 <span class="op">=</span> df[df[<span class="st">"cylinders"</span>] <span class="op">==</span> <span class="dv">4</span>][<span class="st">"horsepower"</span>]</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>cylinders_8 <span class="op">=</span> df[df[<span class="st">"cylinders"</span>] <span class="op">==</span> <span class="dv">8</span>][<span class="st">"horsepower"</span>]</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the test</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>t_stat, p_val <span class="op">=</span> stats.ttest_ind(cylinders_4, cylinders_8, equal_var <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print t statistic value</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"T-statistic: </span><span class="sc">{</span>t_stat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>T-statistic: -19.36963609727327</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-value of the test</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"P-value: </span><span class="sc">{</span>p_val<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 1.8268539721413396e-28</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><strong>Details about <code>R</code> code and output</strong></p>
<p>In order to run this test in <code>R</code>, similar to what we learned in <a href="chapter2-one-pop.html" class="quarto-xref"><span>Chapter 2</span></a> we can use <code>t.test</code> function in R. The function can be used to perform one or two sample t-tests. The relevant arguments of the function are as follows:</p>
<ul>
<li>
<code>x</code> is (non-empty) numeric vector of data values.</li>
<li>
<code>y</code> is also (non-empty) numeric vector of data values (can be <code>NULL</code> if you run a one sample test).</li>
<li>
<code>var.equal</code> is a binary value (TRUE/FALSE) to indicate if <code>R</code> needs to assume equal variance between population of two groups or not. By default the value of <code>var.equal</code> is <code>FALSE</code> but we manually set it to <code>FALSE</code> to make it clear to the reader that we are making an unequal variance assumption in our test.</li>
</ul>
<p>Using <strong>Option 1</strong> or <strong>Option 2</strong> for <code>R</code>, in both outputs we can see the following elements:</p>
<ul>
<li><p><code>t</code> is the test statistic defined in <a href="#eq-t-statistic-unequal-var" class="quarto-xref">Equation&nbsp;<span>3.3</span></a></p></li>
<li><p><code>df</code> is the degrees of freedom for the test. You can manually calculate and confirm/see that it equals <span class="math inline">\(\nu\)</span> that we defined in <a href="#eq-t-statistic-unequal-var" class="quarto-xref">Equation&nbsp;<span>3.3</span></a>.</p></li>
<li><p><code>p-value</code> is the <span class="math inline">\(\textit{p-value}\)</span> of the test. Note that, by default, this is for a two-sided test. If you need to conduct a one-sided test, you can either divide the p-value by two or use the <code>alternative</code> argument in the <code>t.test</code> function. You can read more about it in help documentation of <code>t.test</code> function (type and run help(t.test) in <code>R</code> console and look for <code>alternative</code> argument.)</p></li>
<li><p><code>95 percent confidence interval</code> provides the 95% confidence interval for the parameter of <span class="math inline">\(\mu_1 - \mu_2\)</span>. You can control the level of your confidence interval by setting <code>conf.level</code> to other values between 0 and 1. By default it is set to <code>conf.level = 0.95</code>.</p></li>
<li><p><code>sample estimates</code> gives the sample means for each group, i.e.&nbsp;<span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span>.</p></li>
</ul>
<p><strong>Details about <code>Python</code> code and output</strong></p>
<p>In this example, we perform the test in <code>Python</code>. We use <code>pandas</code> package to read data in <code>Python</code> and <code>scipy</code> for running the test. Here is a breakdown of key points:</p>
<ul>
<li><p><code>cylinders_4</code> and <code>cylinders_8</code> are <code>pandas</code> objects containing the horsepower values for cars with 4 and 8 cylinders, respectively.</p></li>
<li><p>The function <code>ttest_ind</code> from <code>stats</code> module computes the <code>t-test</code> for the means of two independent samples.</p></li>
<li><p>The argument <code>equal_var=False</code> tells <code>Python</code> to assume unequal population variances (similar to setting <code>var.equal = FALSE</code> in <code>t.test</code> function <code>R</code>).</p></li>
<li><p>The function returns two values: <code>t_stat</code> which is the computed t-statistic and <code>p_val</code> which is the <span class="math inline">\(\textit{p-value}\)</span> of the test. By default, <code>ttest_ind</code> performs a two-sided test. For a one-sided test, you would need to adjust the <span class="math inline">\(\textit{p-value}\)</span> accordingly (e.g., divide by two if the t-statistic is in the direction of interest).</p></li>
<li><p>This <code>Python</code> approach is directly comparable to using <code>t.test</code> in <code>R</code>, with the main conceptual difference being how arguments are named and handled.</p></li>
</ul></section><section id="storytelling-1" class="level3" data-number="3.2.10"><h3 data-number="3.2.10" class="anchored" data-anchor-id="storytelling-1">
<span class="header-section-number">3.2.10</span> Storytelling</h3>
<p>Finally, based on the sample we have and the analysis we conducted, we can draw a conclusion about our initial question: <strong>Is the mean horsepower of cars with 8 cylinders statistically different from that of cars with 4 cylinders?</strong></p>
<p>We observed that the <span class="math inline">\(p-\textit{value}\)</span> of the test was extremely small compared to the significance level <span class="math inline">\(\alpha = 0.05\)</span>. This provides strong evidence against the null hypothesis. In simple terms, this means: <em>There is a meaningful difference in the average horsepower between cars with 4 cylinders and those with 8 cylinders.</em></p>
<p>So, if you are shopping for a car with more horsepower, it looks like going for one with 8 cylinders might be the way to go — assuming you don’t mind the extra fuel costs of course!!</p>
</section></section><section id="sec-z-test-ind-samples" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="sec-z-test-ind-samples">
<span class="header-section-number">3.3</span> Two sample z-test for Independent Samples</h2>
<section id="review-2" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="review-2">
<span class="header-section-number">3.3.1</span> Review</h3>
<p>In the tests we have seen so far in <a href="#sec-t-test-ind-samples" class="quarto-xref">Section&nbsp;<span>3.1</span></a> and <a href="#sec-welch-t-test-ind-samples" class="quarto-xref">Section&nbsp;<span>3.2</span></a>, we estimated the variance of each group using the sample variance. For example see <span class="math inline">\(s^2_{x}\)</span> or <span class="math inline">\(s^2_{y}\)</span> defined in formula <a href="#eq-t-statistic-unequal-var" class="quarto-xref">Equation&nbsp;<span>3.3</span></a>. This approach is realistic, as in most cases we do not know the population variance of our variable of interest and it is being estimated by sample variance. However, if the population variance for each group is known we can incorporate this information into our test.</p>
<p>For example, suppose you are analyzing wage differences between high school and college graduates using a large labor market data set. A government labor agency previously conducted extensive research and reported that the true population variances of hourly wages for both groups (based on some historical data) should be as follows:</p>
<ul>
<li>Population variance of wages among <strong>high school graduates</strong>: <span class="math inline">\(\sigma_1^2 = 816\)</span>
</li>
<li>Population variance of wages among <strong>college graduates</strong>: <span class="math inline">\(\sigma_2^2 = 1700\)</span>
</li>
</ul>
<p>Note that this is the <strong>population</strong> variance and not the <strong>sample</strong>. You want to assess whether the average wage differs between the two groups. Since the population variances are known (e.g., from reliable historical studies or large scale sampling in previous studies), a <strong>two-sample z-test</strong> is appropriate instead of a t-test. We treat these groups as independent samples since each person’s wage is recorded once and belongs to a distinct education level.</p>
<p>Since we do not have access to the wages of all individuals in each education group, we take a random sample from each population. Suppose:</p>
<ul>
<li>From the population of <strong>high school graduates</strong> (Population 1), we obtain a sample of size <span class="math inline">\(n\)</span>, denoted as:</li>
</ul>
<p><span class="math display">\[x_1, x_2, \ldots, x_n\]</span></p>
<ul>
<li>From the population of <strong>college graduates</strong> (Population 2), we obtain a sample of size <span class="math inline">\(m\)</span>, denoted as:</li>
</ul>
<p><span class="math display">\[y_1, y_2, \ldots, y_m\]</span> Note that the sample sizes <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> do not need to be equal. Now, the central question becomes <strong>Is there a statistically significant difference between the mean wages of high school and college graduates?</strong> In formal terms, we test the hypotheses:</p>
<p><span class="math display">\[
H_0: \mu_1 = \mu_2 \quad \text{versus} \quad H_A: \mu_1 \ne \mu_2
\]</span> where <span class="math inline">\(\mu_1\)</span> is the population mean of wage in <strong>high school graduates</strong> and <span class="math inline">\(\mu_2\)</span> is the population mean of wage in <strong>college graduates</strong>.</p>
</section><section id="study-design-2" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="study-design-2">
<span class="header-section-number">3.3.2</span> Study Design</h3>
<p>For this example, we will be using the <code>Wage</code> data set from the <code>ISLR2</code> package. This data set contains information about wages and demographic characteristics for 3,000 workers in the Mid-Atlantic region of the United States. Some of the variables of interest are:</p>
<ol type="1">
<li><p><code>education</code>, a categorical variable that records the highest level of education completed by the individual (e.g., “HS Grad”, “College Grad”), and</p></li>
<li><p><code>wage</code>, which denotes the workers raw wage.</p></li>
</ol>
<p>You may be wondering: <strong>Is the mean wage for college graduates statistically different from the mean wage for high school graduates?</strong></p>
<p>To answer this question, we will compare the sample means of these two groups using a two-sample <code>z-test</code> under the assumption that the population variances are known. We use the <code>Wage</code> data set to extract wage data for two groups:</p>
<ul>
<li><p>High school graduates: <code>education == "HS Grad"</code></p></li>
<li><p>College graduates: <code>education == "College Grad"</code></p></li>
</ul></section><section id="data-collection-and-wrangling-2" class="level3" data-number="3.3.3"><h3 data-number="3.3.3" class="anchored" data-anchor-id="data-collection-and-wrangling-2">
<span class="header-section-number">3.3.3</span> Data Collection and Wrangling</h3>
<p>To answer this question, we obtain the data set which is available in the <code>ISLR2</code> package. Note that we consider this data a random sample from the population of working adults. First, we create a new copy of this data set to avoid modifying the original data (this step is optional). Then, we filter the rows to keep only individuals who are either high school graduates or college graduates.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get a copy of data set</span></span>
<span><span class="va">wage_data</span> <span class="op">&lt;-</span> <span class="va">Wage</span></span>
<span></span>
<span><span class="co"># Filter rows to keep only HS Grad and College Grad </span></span>
<span><span class="co"># and then rename the levels to:</span></span>
<span><span class="co"># - HS Grad --&gt; High school graduate</span></span>
<span><span class="co"># - College Grad --&gt; College graduate</span></span>
<span><span class="co"># and finally drop extra levels from education</span></span>
<span><span class="va">wage_data</span> <span class="op">&lt;-</span> <span class="va">wage_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">education</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'2. HS Grad'</span>, <span class="st">'4. College Grad'</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>education <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">education</span>,</span>
<span>                            <span class="st">'2. HS Grad'</span> <span class="op">=</span> <span class="st">'High school graduate'</span>,</span>
<span>                            <span class="st">'4. College Grad'</span> <span class="op">=</span> <span class="st">'College graduate'</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>education <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="va">education</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we randomly split the <code>wage_data</code> data set into training and testing sets, using a 50-50 proportion between train and test following a similar method as we described earlier. This allows us to conduct our test using a subset of the data (train) while reserving the rest (test) for potential follow-up analysis.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Randomly splitting into training and testing sets by level of education</span></span>
<span><span class="va">wage_data_splitting</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">wage_data</span>, prop <span class="op">=</span> <span class="fl">0.5</span>, strata <span class="op">=</span> <span class="va">education</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assigning data points to training and testing sets</span></span>
<span><span class="va">train_wage</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">wage_data_splitting</span><span class="op">)</span></span>
<span><span class="va">test_wage</span>  <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">wage_data_splitting</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sanity check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Training shape:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">train_wage</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training shape: 827 11 </code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Testing shape:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">test_wage</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing shape: 829 11 </code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Training proportions:\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training proportions:</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">train_wage</span><span class="op">$</span><span class="va">education</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
High school graduate     College graduate 
           0.5864571            0.4135429 </code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nTesting proportions:\n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Testing proportions:</code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">test_wage</span><span class="op">$</span><span class="va">education</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
High school graduate     College graduate 
           0.5862485            0.4137515 </code></pre>
</div>
</div>
</section><section id="exploratory-data-analysis" class="level3" data-number="3.3.4"><h3 data-number="3.3.4" class="anchored" data-anchor-id="exploratory-data-analysis">
<span class="header-section-number">3.3.4</span> Exploratory Data Analysis</h3>
<p>Once we have the data and it is split into training and test sets, the next step is to begin exploratory data analysis (EDA) on the training set. The <code>wage</code> variable is a numerical variable that represents hourly earnings. The <code>education</code> variable is a categorical variable that helps us divide observations into two groups.</p>
<p>In particular, we are interested in the distribution of <code>wage</code> in two different groups (<strong>high school graduates</strong> vs <strong>college graduates</strong>). Using a histogram for this variable is a good choice as it allows us to visually inspect how the wages vary within and between these two education levels.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-histogram-wage-by-education" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histogram-wage-by-education-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter3-two-pop_files/figure-html/fig-histogram-wage-by-education-1.png" class="img-fluid figure-img" width="1344">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histogram-wage-by-education-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Hsistogram of wage by education level
</figcaption></figure>
</div>
</div>
</div>
<p>We also look at some descriptive statistics of <code>wage</code> in both groups for better understanding of the data. The descriptive statistics for high school graduates:</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">train_wage</span> <span class="op">|&gt;</span> </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">education</span> <span class="op">==</span> <span class="st">'High school graduate'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>          <span class="fu">select</span><span class="op">(</span><span class="va">wage</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      wage       
 Min.   : 27.14  
 1st Qu.: 78.39  
 Median : 92.90  
 Mean   : 95.27  
 3rd Qu.:109.83  
 Max.   :295.99  </code></pre>
</div>
</div>
<p>and for college graduates:</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">train_wage</span> <span class="op">|&gt;</span> </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">education</span> <span class="op">==</span> <span class="st">'College graduate'</span><span class="op">)</span> </span>
<span>        <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">wage</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      wage       
 Min.   : 34.61  
 1st Qu.: 98.87  
 Median :118.72  
 Mean   :121.44  
 3rd Qu.:141.43  
 Max.   :277.80  </code></pre>
</div>
</div>
<p>Looking at these summary statistics, we can see that the wage distributions for the two education groups have quite a lot of overlap, and there does not appear to be a large difference in the center of distribution In fact, the mean wage for college graduates is only slightly higher, and this is not immediately obvious from the plots.</p>
<p>There appears to be some observations with higher wage values in <code>College Grad</code> group compared to <code>High School Graduate</code>. The following density plot provides additional visual support for this observation:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-density-plot-wage-by-education" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-density-plot-wage-by-education-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter3-two-pop_files/figure-html/fig-density-plot-wage-by-education-1.png" class="img-fluid figure-img" width="1344">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-density-plot-wage-by-education-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Density plot of wage by education level.
</figcaption></figure>
</div>
</div>
</div>
<p>We should avoid making any firm conclusion from EDA at this step. The density of both groups seems to have some overlap but in order to answer our initial question, we need to perform a formal hypothesis testing to see if the observed difference is indeed significant or not.</p>
</section><section id="testing-settings-2" class="level3" data-number="3.3.5"><h3 data-number="3.3.5" class="anchored" data-anchor-id="testing-settings-2">
<span class="header-section-number">3.3.5</span> Testing Settings</h3>
<p>We use a significance level of <span class="math inline">\(\alpha = 0.05\)</span> to conduct the hypothesis test. Since the data we have is a sample from a larger population of workers, we define the following population parameters:</p>
<ul>
<li>
<span class="math inline">\(\mu_{1}\)</span> is the mean wage of individuals with a <strong>high school education</strong> in the population.<br>
</li>
<li>
<span class="math inline">\(\mu_{2}\)</span> is the mean wage of individuals with a <strong>college education</strong> in the population.</li>
</ul>
<p>Our goal is to test whether the population mean wage differs between these two educational groups.</p>
</section><section id="hypothesis-definitions-2" class="level3" data-number="3.3.6"><h3 data-number="3.3.6" class="anchored" data-anchor-id="hypothesis-definitions-2">
<span class="header-section-number">3.3.6</span> Hypothesis Definitions</h3>
<p>We now define the null and alternative hypothesis. Recall the main inquiry we had:</p>
<p><strong>Is the mean wage for college graduates statistically different from the mean wage for high school graduates?</strong></p>
<p>This translates into the following null and alternative hypotheses:</p>
<p><span class="math display">\[H_0: \mu_{1} = \mu_{2} \quad vs \quad H_a: \mu_{1} \neq \mu_{2}\]</span></p>
</section><section id="test-flavour-and-components-2" class="level3" data-number="3.3.7"><h3 data-number="3.3.7" class="anchored" data-anchor-id="test-flavour-and-components-2">
<span class="header-section-number">3.3.7</span> Test Flavour and Components</h3>
<p>To test this hypothesis, we use the <strong>two-sample z-test for independent samples</strong> with known population variances, which compares the sample means and incorporates the known variability within each population. Note that the samples are independent. The test statistic for this test is computed as:</p>
<p><span id="eq-z-statistic"><span class="math display">\[z = \frac{\bar{x} - \bar{y}}{\sqrt{\frac{\sigma_1^2}{n} + \frac{\sigma_2^2}{m}}} \tag{3.4}\]</span></span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\bar{x}\)</span> is the mean wage of individuals with a high school education in the sample.</li>
<li>
<span class="math inline">\(\bar{y}\)</span> is the mean wage of individuals with a college education in the sample.</li>
<li>
<span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are the <strong>known population variances</strong> of the two groups</li>
<li>
<span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> are the sample sizes of the two groups</li>
</ul>
<p>Because population variances are known, the standard error of the difference in sample means is computed directly from the population variances, avoiding the need to estimate variance from the samples.</p>
<div class="Heads-up">
<div class="Heads-up-header">
<p>Heads-up!</p>
</div>
<div class="Heads-up-container">
<p>Note that <span class="math inline">\(z\)</span> defined in <a href="#eq-z-statistic" class="quarto-xref">Equation&nbsp;<span>3.4</span></a> itself is a random variable meaning that it would vary from sample to sample.</p>
</div>
</div>
</section><section id="inferential-conclusions-2" class="level3" data-number="3.3.8"><h3 data-number="3.3.8" class="anchored" data-anchor-id="inferential-conclusions-2">
<span class="header-section-number">3.3.8</span> Inferential Conclusions</h3>
<p>As you can see, the test statistic defined in <a href="#eq-z-statistic" class="quarto-xref">Equation&nbsp;<span>3.4</span></a> computes the difference between <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> and scales it based on the known variance of this difference (or more precisely standard deviation of the difference!). Now the question is whether this difference is significant or not? To answer this, we need to understand the behavior of the statistic we defined in <a href="#eq-z-statistic" class="quarto-xref">Equation&nbsp;<span>3.4</span></a> (<span class="math inline">\(z\)</span>) and what typical values it can take.</p>
<p>As we shown before, knowing the distribution of this statistic allows us to compute the <span class="math inline">\(\textit{p-value}\)</span> of the test as follows:</p>
<p><span id="eq-z-test-pvalue"><span class="math display">\[\textit{p-value} = 2 \times Pr(Z \ge |z|) \tag{3.5}\]</span></span></p>
<div class="Heads-up">
<div class="Heads-up-header">
<p>Upper case <span class="math inline">\(Z\)</span> vs lower case <span class="math inline">\(z\)</span>!</p>
</div>
<div class="Heads-up-container">
<ul>
<li>The lower case <span class="math inline">\(z\)</span> in <a href="#eq-z-test-pvalue" class="quarto-xref">Equation&nbsp;<span>3.5</span></a> is the statistic computed from the sample (<a href="#eq-z-statistic" class="quarto-xref">Equation&nbsp;<span>3.4</span></a>).</li>
<li>The upper case <span class="math inline">\(Z\)</span> though is a notation to use for random variable.</li>
<li>This random variable follows a Normal distribution with mean zero and standard deviation of one.</li>
<li>Looking at the formula in <a href="#eq-z-test-pvalue" class="quarto-xref">Equation&nbsp;<span>3.5</span></a>, we are essentially calculating how likely it is to observe a value as extreme as <span class="math inline">\(z\)</span> under the null hypothesis - a Normal distribution with mean zero and standard deviation of one.</li>
</ul>
</div>
</div>
<p><br></p>
<div class="Tip">
<div class="Tip-header">
<p>Interpreting the Test Statistic and p-value!</p>
</div>
<div class="Tip-container">
<ul>
<li><p>Under the assumption that the null hypothesis is correct (i.e., <span class="math inline">\(\mu_1 = \mu_2\)</span>), the test statistic <span class="math inline">\(z\)</span> follows the <strong>standard normal distribution</strong> that textbooks usually denote it by <span class="math inline">\(N(0,1)\)</span>. The first element is mean (0) and the second one is the standard deviation (1).</p></li>
<li><p><strong>Note:</strong> The probability is multiplied by two because we are conducting a two-sided test (alternative hypothesis: <span class="math inline">\(\mu_1 \neq \mu_2\)</span>). For a one-sided test (e.g., <span class="math inline">\(\mu_1 &gt; \mu_2\)</span> or <span class="math inline">\(\mu_1 &lt; \mu_2\)</span>) this multiplication is not needed.</p></li>
<li><p>We compare the <span class="math inline">\(\textit{p-value}\)</span> to our significance level <span class="math inline">\(\alpha\)</span>. If the <span class="math inline">\(\textit{p-value}\)</span> is less than <span class="math inline">\(\alpha\)</span>, then we have evidence against the null hypothesis.</p></li>
<li><p>The reasoning is: assuming the null hypothesis is true, the test statistic should follow a standard normal distribution. A very small <span class="math inline">\(\textit{p-value}\)</span> means our observed <span class="math inline">\(z\)</span> is unlikely under this distribution, and so it is unlikely the null hypothesis is correct.</p></li>
</ul>
</div>
</div>
</section><section id="how-to-run-the-two-sample-z-test-in-r-and-python" class="level3" data-number="3.3.9"><h3 data-number="3.3.9" class="anchored" data-anchor-id="how-to-run-the-two-sample-z-test-in-r-and-python">
<span class="header-section-number">3.3.9</span> How to run the two-sample <code>z-test</code> in <code>R</code> and <code>Python</code>
</h3>
<p>The following examples show how to implement the two-sample <code>z-test</code> for independent samples with <strong>known population variances</strong> in both <code>R</code> and <code>Python</code> using the <code>Wage</code> data set. Note that we know the <strong>population variances</strong> <span class="math inline">\(\sigma_1^2 = 816\)</span> for high school graduates and <span class="math inline">\(\sigma_2^2 = 1700\)</span> for college graduates.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Filter test_wage data to create two groups: </span></span>
<span><span class="co"># High school graduates and college graduates</span></span>
<span><span class="va">hs_wages</span> <span class="op">&lt;-</span> <span class="va">test_wage</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">education</span> <span class="op">==</span> <span class="st">'High school graduate'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">wage</span><span class="op">)</span></span>
<span></span>
<span><span class="va">col_wages</span> <span class="op">&lt;-</span> <span class="va">test_wage</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">education</span> <span class="op">==</span> <span class="st">'College graduate'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">wage</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the known population variances</span></span>
<span><span class="va">sigma2_hs</span> <span class="op">&lt;-</span> <span class="fl">816</span></span>
<span><span class="va">sigma2_col</span> <span class="op">&lt;-</span> <span class="fl">1700</span></span>
<span></span>
<span><span class="co"># Run two-sample z-test with known variances</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">z.test</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">hs_wages</span>,</span>
<span>  y <span class="op">=</span> <span class="va">col_wages</span>,</span>
<span>  sigma.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sigma2_hs</span><span class="op">)</span>,  <span class="co"># standard deviation for group 1</span></span>
<span>  sigma.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sigma2_col</span><span class="op">)</span>, <span class="co"># standard deviation for group 2</span></span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two-sample z-Test

data:  hs_wages and col_wages
z = -12.079, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -36.16323 -26.06588
sample estimates:
mean of x mean of y 
 96.29123 127.40579 </code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data set</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/test_wage.csv'</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract wages for high school graduates and college graduates</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>hs_wages <span class="op">=</span> df.loc[df[<span class="st">'education'</span>] <span class="op">==</span> <span class="st">'High school graduate'</span>, <span class="st">'wage'</span>].to_numpy()</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>col_wages <span class="op">=</span> df.loc[df[<span class="st">'education'</span>] <span class="op">==</span> <span class="st">'College graduate'</span>, <span class="st">'wage'</span>].to_numpy()</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample sizes</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>n1 <span class="op">=</span> <span class="bu">len</span>(hs_wages)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>n2 <span class="op">=</span> <span class="bu">len</span>(col_wages)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample means</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>mean1 <span class="op">=</span> np.mean(hs_wages)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>mean2 <span class="op">=</span> np.mean(col_wages)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard deviations (square root of known variances)</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="op">=</span> np.sqrt(<span class="dv">816</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="op">=</span> np.sqrt(<span class="dv">1700</span>)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standard error using known population std dev</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>se <span class="op">=</span> np.sqrt( (sigma1<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> n1) <span class="op">+</span> (sigma2<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> n2) )</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate z-statistic</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>z_stat <span class="op">=</span> (mean1 <span class="op">-</span> mean2) <span class="op">/</span> se</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-sided p-value</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>p_value <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> norm.cdf(<span class="op">-</span><span class="bu">abs</span>(z_stat))</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Print z-statistic and p-value</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Z-statistic: </span><span class="sc">{</span>z_stat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Z-statistic: -12.079082633142994</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"P-value: </span><span class="sc">{</span>p_value<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 1.3623112108098036e-33</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>In order to run the two-sample z-test with known population variances, we use the <code>z.test</code> function from the <code>BSDA</code> package in <code>R</code> which have a similar input and output to <code>t.test</code> function. This function is designed to handle one and two sample <code>z-tests</code> when population standard deviations are known. The key arguments of <code>z.test</code> for a two-sample test are:</p>
<ul>
<li>
<code>x</code>: a numeric vector of data values for group 1.</li>
<li>
<code>y</code>: a numeric vector of data values for group 2.</li>
<li>
<code>sigma_x</code>: the known population <strong>standard deviation</strong> for group 1.</li>
<li>
<code>sigma_y</code>: the known population <strong>standard deviation</strong> for group 2.</li>
<li>
<code>alternative</code>: specifies the alternative hypothesis; <code>"two.sided"</code> by default for a two-sided test.</li>
</ul>
<p><strong>Note</strong>: <code>sigma_x</code> and <code>sigma_y</code> expects the standard deviation of each group and <strong>not</strong> the variance. As a result in the <code>R</code> code in tabset we passed <code>sqrt(sigma2_hs)</code> and <code>sqrt(sigma2_col)</code>.</p>
<p>When you run the test, the output includes:</p>
<ul>
<li>
<code>statistic</code>: the calculated <span class="math inline">\(z\)</span> test statistic defined in <a href="#eq-z-statistic" class="quarto-xref">Equation&nbsp;<span>3.4</span></a>.</li>
<li>
<code>p.value</code>: the p-value for the test based on the standard normal distribution, defined in <a href="#eq-z-test-pvalue" class="quarto-xref">Equation&nbsp;<span>3.5</span></a>.</li>
<li>
<code>conf.int</code>: the confidence interval for the difference in means <span class="math inline">\(\mu_1 - \mu_2\)</span>.</li>
<li>
<code>estimate</code>: the sample means for each group.</li>
</ul>
<p><strong>Note:</strong> The <code>z.test</code> function assumes that the population standard deviations are known and uses them directly to compute the test statistic and confidence interval. This differs from tests that estimate variance from the samples such as <code>t-tests</code> that we discussed in <a href="#sec-t-test-ind-samples" class="quarto-xref">Section&nbsp;<span>3.1</span></a> and <a href="#sec-welch-t-test-ind-samples" class="quarto-xref">Section&nbsp;<span>3.2</span></a>.</p>
</section><section id="storytelling-2" class="level3" data-number="3.3.10"><h3 data-number="3.3.10" class="anchored" data-anchor-id="storytelling-2">
<span class="header-section-number">3.3.10</span> Storytelling</h3>
<p>In summary, these results tell us that the observed difference in wages is highly unlikely to have occurred by random chance if the true means were equal. Therefore, we conclude that college graduates earn significantly more than high school graduates on average.</p>
</section></section><section id="sec-t-test-paired-samples" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="sec-t-test-paired-samples">
<span class="header-section-number">3.4</span> Two sample t-test for Paired Samples</h2>
<section id="review-3" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="review-3">
<span class="header-section-number">3.4.1</span> Review</h3>
<p>In this section, we discuss the two sample t-test for paired samples which is used when we have two sets of related observations. Unlike the two-sample t-tests for independent samples that we discussed so far (such as the Student’s or Welch’s t-test), the paired t-test is appropriate when the two samples are dependent. This means each observation in one sample can be naturally paired with an observation in the other.</p>
<p>Examples of such are before-and-after measurements on the same subjects, or matched subjects across two different conditions. The key idea is that the test evaluates whether the mean difference between paired observations is significantly different from zero.</p>
<div class="Heads-up">
<div class="Heads-up-header">
<p>When to use this test!</p>
</div>
<div class="Heads-up-container">
<p>We use the paired sample t-test when:</p>
<ul>
<li><p>The data consist of paired observations.</p></li>
<li><p>The differences between pairs are approximately normally distributed or at least symmetric (especially important for small sample sizes).</p></li>
<li><p>And the measurement scale is continuous.</p></li>
</ul>
</div>
</div>
<p>Paired samples arise when each observation in one group is matched or linked to an observation in the other group. This structure is typical in before-and-after studies, matched-subject designs, or repeated measures on the same individuals. A classic example comes from health sciences.</p>
<p>Suppose you are investigating whether a new diet plan reduces blood pressure. You recruit a group of participants and record their blood pressure <strong>before</strong> starting the diet. <strong>After</strong> following the diet for two months, you measure their blood pressure again. In this scenario, each participant contributes two measurements: one before <strong>the intervention</strong> and one after. Note that these measurements are not independent as they come from the same person. Therefore we treat them as paired.</p>
<p>To formulate the problem and hypothesis, let us assume that each individual has two measurements:</p>
<ul>
<li><p>Before the diet: <span class="math inline">\(x_1, x_2, \ldots, x_n\)</span></p></li>
<li><p>After the diet: <span class="math inline">\(y_1, y_2, \ldots, y_n\)</span></p></li>
</ul>
<p>Note that in this case the sample size is the same (in both before and after diet sample we have <span class="math inline">\(n\)</span> observations). We call this a paired sample. Since the samples are paired, we define the difference for each individual as follows:</p>
<p><span class="math display">\[d_i = y_i - x_i \quad \textit{for} \quad i = 1,2, \ldots, n\]</span> Each <span class="math inline">\(d_i\)</span> is the difference of blood pressure after and before using new diet for the <span class="math inline">\(i\)</span>-th person. Now the main statistical question is:</p>
<p><strong>Is there a significant difference in the mean blood pressure before and after the diet?</strong></p>
<p>Now if the treatment is effective, one expect to have difference sample average of around zero. In other words, we test the following hypothesis:</p>
<p><span class="math display">\[H_0: \mu_d = 0 \quad \text{versus} \quad H_A: \mu_d \ne 0\]</span></p>
<p>where <span class="math inline">\(\mu_d\)</span> is a parameter to show the population mean differences. We talk more about this later in this section.</p>
</section><section id="study-design-3" class="level3" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="study-design-3">
<span class="header-section-number">3.4.2</span> Study Design</h3>
<p>Consider a clinical investigation examining whether an innovative medication can lower LDL cholesterol levels in adults diagnosed with hypercholesterolemia which basically means having too much cholesterol in the blood. This can increase the risk of heart problems because cholesterol can build up in blood vessels and block blood flow.</p>
<p>The study monitors a group of <span class="math inline">\(n=120\)</span> participants over time, recording LDL cholesterol concentrations prior to treatment and again after an 8-week course of taking the pill to reduce LDL levels. The outcome of interest is the LDL cholesterol measurement (in mg/dL), a widely used biomarker for cardiovascular risk.</p>
<p><strong>Note:</strong> This design is not appropriate for evaluating the effectiveness of a new treatment. In practice, more advanced and rigorous statistical methods are used in biostatistics to address such questions. These methods are routinely applied in medical research when developing new treatments and approving medications for public use (for example, through Health Canada). We use this simplified example here only to illustrate the idea behind the paired t-test, as it provides an intuitive way to see how paired data are analyzed.</p>
</section><section id="data-collection-and-wrangling-3" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="data-collection-and-wrangling-3">
<span class="header-section-number">3.4.3</span> Data Collection and Wrangling</h3>
<p>In this section, we will work with a simulated dataset that has been specifically created to illustrate the concept of paired t-test for this example. In other words, the dataset for this study is generated under a known scenario. The code below generates the dataset we will be using. While running these lines is not strictly necessary if you are only interested in following along with the analysis, we recommend reading <a href="B-simulated-datasets.html" class="quarto-xref"><span>Appendix B</span></a> for a deeper understanding of how and why the data were generated in this way.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># set.seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set number of participants</span></span>
<span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fl">120</span>   </span>
<span></span>
<span><span class="co"># Set the average decrease in LDL due to treatment</span></span>
<span><span class="va">Delta</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span></span>
<span><span class="co"># Step 1: Generate LDL before treatment</span></span>
<span><span class="va">ldl_before</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_patients</span>, mean <span class="op">=</span> <span class="fl">160</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Generate LDL after treatment</span></span>
<span><span class="va">ldl_after</span> <span class="op">&lt;-</span> <span class="va">ldl_before</span> <span class="op">-</span> <span class="va">Delta</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_patients</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create final dataset</span></span>
<span><span class="va">cholesterol_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_patients</span>,</span>
<span>  LDL_before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ldl_before</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  LDL_after  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ldl_after</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display first few observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cholesterol_data</span>, <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   patient_id LDL_before LDL_after
1           1      157.2     154.8
2           2      158.8     155.4
3           3      167.8     164.8
4           4      160.4     157.6
5           5      160.6     160.0
6           6      168.6     165.4
7           7      162.3     160.0
8           8      153.7     151.3
9           9      156.6     153.1
10         10      157.8     155.2</code></pre>
</div>
</div>
<p>Note that <code>cholesterol_data</code> contains two columns: <code>LDL_before</code>, which records each patient’s LDL level before taking the new medication, and <code>LDL_after</code>, which records the LDL level after taking the new medication. This setup clearly illustrates the paired nature of the data: each row corresponds to a single individual, with measurements taken at two different points in time: <strong>before</strong> and <strong>after</strong> the treatment. Because the observations are linked within each person, the analysis must account for this pairing rather than treating the two sets of values as independent samples.</p>
<p>The next step in this type of analysis is to calculate the paired differences for each individual. If the medication is effective, we expect the difference between the after and before measurements to be substantially different from zero; if it is not effective, the differences should be close to zero on average. The code below adds a new column, LDL_diff, which stores the difference <code>LDL_diff = LDL_after - LDL_before</code> for each patient:</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cholesterol_data</span> <span class="op">&lt;-</span> <span class="va">cholesterol_data</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>LDL_diff <span class="op">=</span> <span class="va">LDL_after</span> <span class="op">-</span> <span class="va">LDL_before</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we randomly split the <code>cholesterol_data</code> data set into training and testing sets, using a 50-50 proportion between train and test. Note that in this example, we do not need to use <code>rsample</code> package as we did before since there is no grouping in the data.</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Splitting the data set into train and test sets</span></span>
<span><span class="va">train_indices</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">cholesterol_data</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.50</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">cholesterol_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_cholesterol</span> <span class="op">&lt;-</span> <span class="va">cholesterol_data</span><span class="op">[</span><span class="va">train_indices</span>, <span class="op">]</span></span>
<span><span class="va">test_cholesterol</span>  <span class="op">&lt;-</span> <span class="va">cholesterol_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_indices</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="exploratory-data-analysis-1" class="level3" data-number="3.4.4"><h3 data-number="3.4.4" class="anchored" data-anchor-id="exploratory-data-analysis-1">
<span class="header-section-number">3.4.4</span> Exploratory Data Analysis</h3>
<p>Before performing any formal statistical tests, it is important to explore the dataset to gain an initial understanding of its characteristics. For paired data like this, our main objectives is to visualize the paired differences to see whether LDL levels tend to decrease after the medication. To address this objective, we can create a density of the paired differences. If the center of this distribution (e.g., the mean) is far from zero, it may indicate that the medication is effective.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-density-plot-ldl-diff" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-density-plot-ldl-diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter3-two-pop_files/figure-html/fig-density-plot-ldl-diff-1.png" class="img-fluid figure-img" width="1344">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-density-plot-ldl-diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Density Plot of Paired LDL Levels Differences
</figcaption></figure>
</div>
</div>
</div>
<p>From the density plot, most LDL differences appear to fall below zero with the distribution noticeably centered away from it. This suggests a general decrease in LDL levels after treatment, but the observation should be verified through formal statistical testing. From this plot, it is not clear if this reduction is significant or not.</p>
</section><section id="testing-settings-3" class="level3" data-number="3.4.5"><h3 data-number="3.4.5" class="anchored" data-anchor-id="testing-settings-3">
<span class="header-section-number">3.4.5</span> Testing Settings</h3>
<p>We use a significance level of <span class="math inline">\(\alpha = 0.05\)</span> to conduct the hypothesis test. Since our data represent a sample from a larger population of patients, we define the following population parameter:</p>
<ul>
<li>
<span class="math inline">\(\mu_{d}\)</span> is the mean difference in LDL levels (after treatment – before treatment) for all patients in the population.</li>
</ul>
<p>Our goal is to test whether the population mean difference <span class="math inline">\(\mu_{d}\)</span> is equal to zero. This would indicate no change in LDL levels after treatment versus the alternative that <span class="math inline">\(\mu_{d}\)</span> is not zero which suggests a treatment effect.</p>
<div class="Tip">
<div class="Tip-header">
<p>What is <span class="math inline">\(\mu_s\)</span> as a parameter here?</p>
</div>
<div class="Tip-container">
<ul>
<li><p>Here the notation of <span class="math inline">\(\mu_d\)</span> is the population mean of the differences of <span class="math inline">\(d_i\)</span> which is an unknown parameter in the population.</p></li>
<li><p>To test this hypothesis, we use the paired t-test, which is essentially a one-sample t-test on the differences <span class="math inline">\(d_1, d_2, \ldots, d_n\)</span>.</p></li>
<li><p>We test <span class="math inline">\(\mu_d=0\)</span> because if there is an actual effect of diet on blood pressure, we expect the null hypothesis to be rejected.</p></li>
</ul>
</div>
</div>
</section><section id="hypothesis-definitions-3" class="level3" data-number="3.4.6"><h3 data-number="3.4.6" class="anchored" data-anchor-id="hypothesis-definitions-3">
<span class="header-section-number">3.4.6</span> Hypothesis Definitions</h3>
<p>We now define the null and alternative hypotheses. Recall the main question we posed:</p>
<p><strong>Is the mean LDL level after treatment statistically different from the mean LDL level before treatment for the same patients?</strong></p>
<p>Because the measurements are paired, this question is equivalent to asking whether the mean difference in LDL levels (<em>after - before</em>) is zero. This leads to the following hypotheses:</p>
<p><span class="math display">\[H_0: \mu_d = 0 \quad \textit{(no mean change in LDL levels)}\]</span></p>
<p><span class="math display">\[H_a: \mu_d \neq 0 \quad \textit{(mean LDL levels change after treatment)}\]</span></p>
</section><section id="test-flavour-and-components-3" class="level3" data-number="3.4.7"><h3 data-number="3.4.7" class="anchored" data-anchor-id="test-flavour-and-components-3">
<span class="header-section-number">3.4.7</span> Test Flavour and Components</h3>
<p>To test this hypothesis, we use the <strong>paired t-test</strong>, which compares the mean difference in LDL levels before and after treatment within the same individuals. Note that the test is done on the paired differences. The test accounts for the fact that the measurements are not independent but rather are paired. The test statistic for this test is computed as:</p>
<p><span id="eq-t-statistic-paired"><span class="math display">\[t = \frac{\bar{d}}{ s_d / \sqrt{n} } \tag{3.6}\]</span></span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\bar{d}\)</span> is the mean of the differences in LDL levels (post-treatment minus pre-treatment) for all participants.</p></li>
<li><p><span class="math inline">\(s_d\)</span> is the standard deviation of these differences and is computed as:</p></li>
</ul>
<p><span class="math inline">\(s_d = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (d_i - \bar{d})^2}\)</span></p>
<ul>
<li>
<span class="math inline">\(n\)</span> is the number of paired observations (participants).</li>
</ul></section><section id="inferential-conclusions-3" class="level3" data-number="3.4.8"><h3 data-number="3.4.8" class="anchored" data-anchor-id="inferential-conclusions-3">
<span class="header-section-number">3.4.8</span> Inferential Conclusions</h3>
<p>As you can see in <a href="#eq-t-statistic-paired" class="quarto-xref">Equation&nbsp;<span>3.6</span></a>, the statistic divide the sample mean of differences and scale it according to the standard deviation. The idea is very similar to the other tests that we have been working on so far. Under the null hypothesis, the test statistic defined in <a href="#eq-t-statistic-paired" class="quarto-xref">Equation&nbsp;<span>3.6</span></a> follows a t-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom. For this test, we can compute the <span class="math inline">\(\textit{p-value}\)</span> as:</p>
<p><span class="math display">\[\textit{p-value} = 2 \times \Pr(T_{n - 1} \ge |t|)\]</span></p>
<div class="Tip">
<div class="Tip-header">
<p>Remember!</p>
</div>
<div class="Tip-container">
<ul>
<li>When we run this test, we make the following assumptions:</li>
</ul>
<ol type="1">
<li><p>either the sample size is large enough (we are thinking about <span class="math inline">\(n=30\)</span> at least) so that central limit theorem assumptions work well, or</p></li>
<li><p>the distribution of our sample in each group is normal or symmetric enough.</p></li>
</ol>
<ul>
<li>If the normality assumption is also not satisfied (e.g., due to skewed distributions or outliers) or we have a very small sample size, we may turn to a non-parametric alternative, such as the Mann–Whitney–Wilcoxon test, which compares the ranks of the observations across groups rather than the raw values but this book will not cover it. You can read more about it LINK.</li>
</ul>
</div>
</div>
</section><section id="how-to-run-the-two-sample-paired-t-test-in-r-and-python" class="level3" data-number="3.4.9"><h3 data-number="3.4.9" class="anchored" data-anchor-id="how-to-run-the-two-sample-paired-t-test-in-r-and-python">
<span class="header-section-number">3.4.9</span> How to run the two-sample paired t-test in <code>R</code> and <code>Python</code>
</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract LDL measurements before and after treatment</span></span>
<span><span class="va">ldl_before</span> <span class="op">&lt;-</span> <span class="va">test_cholesterol</span> <span class="op">|&gt;</span>  <span class="fu">pull</span><span class="op">(</span><span class="va">LDL_before</span><span class="op">)</span></span>
<span><span class="va">ldl_after</span>  <span class="op">&lt;-</span> <span class="va">test_cholesterol</span> <span class="op">|&gt;</span>  <span class="fu">pull</span><span class="op">(</span><span class="va">LDL_after</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run paired t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ldl_before</span>, y <span class="op">=</span> <span class="va">ldl_after</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  ldl_before and ldl_after
t = 18.248, df = 59, p-value &lt; 2.2e-16
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 2.141281 2.668719
sample estimates:
mean difference 
          2.405 </code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_rel</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/test_cholesterol.csv'</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract LDL measurements before and after treatment</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>ldl_before <span class="op">=</span> df[<span class="st">'LDL_before'</span>].to_numpy()</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>ldl_after <span class="op">=</span> df[<span class="st">'LDL_after'</span>].to_numpy()</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Run paired t-test</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>t_stat, p_value <span class="op">=</span> ttest_rel(ldl_before, ldl_after)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"T-statistic: </span><span class="sc">{</span>t_stat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>T-statistic: 18.248188665420518</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"P-value: </span><span class="sc">{</span>p_value<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 6.125701137511457e-26</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><strong>Details about <code>R</code> code and output</strong></p>
<p>Key arguments of the t.test function in R for a paired test are:</p>
<ul>
<li><p><code>x</code>: numeric vector of measurements before treatment.</p></li>
<li><p><code>y</code>: numeric vector of measurements after treatment.</p></li>
<li><p><code>paired = TRUE</code>: indicates that the samples are related.</p></li>
</ul>
<p>The output includes:</p>
<ul>
<li><p><code>statistic</code>: the calculated t-test statistic (here, t = 22.303).</p></li>
<li><p><code>df</code>: the degrees of freedom for t-distribution</p></li>
<li><p><code>p.value</code>: the p-value for testing the null hypothesis that the true mean difference is zero.</p></li>
<li><p><code>conf.int</code>: the 95% confidence interval for the mean difference in LDL levels.</p></li>
<li><p><code>estimate</code>: the estimated mean of the paired differences.</p></li>
</ul>
<p><strong>Note:</strong> The <code>paired t-test</code> assumes that the differences between pre and post-treatment measurements are approximately normally distributed. Unlike independent sample tests, this test directly accounts for the correlation between repeated measurements on the same patient.</p>
<p><strong>Details about <code>Python</code> code and output</strong></p>
<p>When running a paired t-test in Python using <code>scipy.stats.ttest_rel</code>, the main components are:</p>
<ul>
<li><p><code>x</code>: numeric array of measurements before treatment (<code>ldl_before</code>).</p></li>
<li><p><code>y</code>: numeric array of measurements after treatment (<code>ldl_after</code>).</p></li>
</ul>
<p>The output includes:</p>
<ul>
<li><p><code>t_stat</code>: the computed t-test statistic for the paired differences.</p></li>
<li><p><code>p_value</code>: the probability of observing the data if the null hypothesis (no difference) is true.</p></li>
</ul></section><section id="storytelling-3" class="level3" data-number="3.4.10"><h3 data-number="3.4.10" class="anchored" data-anchor-id="storytelling-3">
<span class="header-section-number">3.4.10</span> Storytelling</h3>
<p>Based on our analysis, we asked: <strong>Did LDL levels change significantly after treatment?</strong> The paired t-test gave a very small <span class="math inline">\(\textit{p-value}\)</span>, far below <span class="math inline">\(\alpha = 0.05\)</span> providing strong evidence against the null hypothesis. In simple terms, this means LDL levels after treatment are significantly lower than before. On average, the reduction was about 2.4 units, with the true effect likely between 2.1 and 2.7 units. In summary, these results indicate that the observed reduction in LDL levels is highly unlikely to have occurred by chance if there were no true effect.</p>
<p><strong>Note:</strong> Compare the 2.4-unit reduction that we estimated from our sample to the value we set for the <code>Delta</code> variable in our simulation. Also note that <code>Delta</code> is the true underlying mean reduction built into the simulated population not a value estimated from data. The sample mean reduction (2.4 units) serves as our estimate of this true effect. If our sample is representative and the assumptions of the paired t-test are met, the sample estimate should be close to the true value of <code>Delta</code> as the sample size increases. Also <code>Delta</code>, the true underlying mean reduction, is within boundary estimate of 2.1 and 2.7 units. If you are interested, try running the analysis by increasing the sample size (the <code>n_patients</code> variable in the code) to see what happens to the results!</p>
</section></section><section id="tests-for-two-population-proportions" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="tests-for-two-population-proportions">
<span class="header-section-number">3.5</span> Tests for Two Population Proportions</h2>
<section id="review-4" class="level3" data-number="3.5.1"><h3 data-number="3.5.1" class="anchored" data-anchor-id="review-4">
<span class="header-section-number">3.5.1</span> Review</h3>
<p>In the examples we studied in <a href="chapter2-one-pop.html" class="quarto-xref"><span>Chapter 2</span></a>, we estimated the proportion of a population based on the sample proportion <span class="math inline">\(\hat{p}\)</span>. This is often the case in practice, as the population proportion is typically unknown and must be inferred from sample data. When we are comparing two groups and wish to test whether their underlying proportions differ, we can extend this idea to a two-proportion test.</p>
<p>Suppose you are investigating support for a new policy among two different regions, Region A and Region B. Each individual either <strong>supports the policy</strong> (coded as 1) or <strong>does not support it</strong> (coded as 0). You want to determine if the proportion of supporters of the new policy is significantly different between Region A and Region B.</p>
<p>Formally, let:</p>
<p><strong>Region A (Population 1):</strong> each individual either supports the policy (coded as 1) or policy (coded as 0).</p>
<p><strong>Region B (Population 2):</strong> defined in the same way.</p>
<p>From each population, we take a random sample:</p>
<ul>
<li><p>From Region A, a sample of size <span class="math inline">\(n\)</span>, with observed sample proportion of support <span class="math inline">\(\hat{p}_A\)</span>.</p></li>
<li><p>From Region B, a sample of size <span class="math inline">\(m\)</span>, with observed sample proportion of support <span class="math inline">\(\hat{p}_B\)</span>.</p></li>
</ul>
<p>where <span class="math inline">\(\hat{p}_A\)</span> and <span class="math inline">\(\hat{p}_B\)</span> are the estimates for the <span class="math inline">\(p_A\)</span> and <span class="math inline">\(p_B\)</span>. Note that <span class="math inline">\(p_A\)</span> and <span class="math inline">\(p_B\)</span> are the true proportion of new policy supporters in Region A and Region B and we estimate them by <span class="math inline">\(\hat{p}_A\)</span> and <span class="math inline">\(\hat{p}_B\)</span>.</p>
<p>The main statistical question becomes: <strong>Is there a significant difference between the true population proportions of support in the two regions?</strong></p>
<p>We formalize this as a hypothesis test:</p>
<p><span class="math display">\[
H_0: p_A = p_B \quad \text{versus} \quad H_A: p_A \ne p_B
\]</span></p>
<p>To answer this, we use the <strong>two-sample z-test for population proportions</strong>, which compares the observed sample proportions (i.e.&nbsp;<span class="math inline">\(\hat{p}_A\)</span> and <span class="math inline">\(\hat{p}_B\)</span>) while accounting for the variability expected under the null hypothesis.</p>
</section><section id="study-design-4" class="level3" data-number="3.5.2"><h3 data-number="3.5.2" class="anchored" data-anchor-id="study-design-4">
<span class="header-section-number">3.5.2</span> Study Design</h3>
<p>Consider a survey aimed at estimating support for a new environmental policy in two regions of a country. Researchers randomly sample Region A (n = 150 individuals) and Region B (m = 200 individuals), recording whether each participant supports the new policy. The main outcome of interest is whether an individual supports or does not support the policy. In the next section, we will show the details of a generated dataset to simulate this real scenario in practice.</p>
</section><section id="data-collection-and-wrangling-4" class="level3" data-number="3.5.3"><h3 data-number="3.5.3" class="anchored" data-anchor-id="data-collection-and-wrangling-4">
<span class="header-section-number">3.5.3</span> Data Collection and Wrangling</h3>
<p>Similar to previous example, we will work with a simulated dataset that has been specifically created to illustrate the concept of tests for two populations. The code below generates the dataset we will be using. While running these lines is not strictly necessary if you are only interested in following along with the analysis, we recommend reading <a href="B-simulated-datasets.html" class="quarto-xref"><span>Appendix B</span></a> for a deeper understanding of how and why the data were generated in this way.</p>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set sample sizes</span></span>
<span><span class="va">n_A</span> <span class="op">&lt;-</span> <span class="fl">150</span></span>
<span><span class="va">n_B</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># Set the values for true population proportions</span></span>
<span><span class="va">p_A</span> <span class="op">&lt;-</span> <span class="fl">0.57</span></span>
<span><span class="va">p_B</span> <span class="op">&lt;-</span> <span class="fl">0.43</span></span>
<span></span>
<span><span class="co"># Generate binary outcomes for survey responses</span></span>
<span><span class="va">support_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n_A</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_A</span><span class="op">)</span></span>
<span><span class="va">support_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n_B</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_B</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create dataset</span></span>
<span><span class="va">policy_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="va">n_A</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'B'</span>, <span class="va">n_B</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">support_A</span>, <span class="va">support_B</span><span class="op">)</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The dataset contains a region column and a support column indicating if the participant supports the policy. To have a better picture of dataset, we take a look at the frequency table.</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">policy_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span> <span class="fu">desc</span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  region count
  &lt;chr&gt;  &lt;int&gt;
1 B        200
2 A        150</code></pre>
</div>
</div>
</section><section id="exploratory-data-analysis-2" class="level3" data-number="3.5.4"><h3 data-number="3.5.4" class="anchored" data-anchor-id="exploratory-data-analysis-2">
<span class="header-section-number">3.5.4</span> Exploratory Data Analysis</h3>
<div class="cell">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">policy_summary</span> <span class="op">&lt;-</span> <span class="va">policy_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">region</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, supporters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">support</span><span class="op">)</span>, prop_support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">support</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">policy_summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  region     n supporters prop_support
  &lt;chr&gt;  &lt;int&gt;      &lt;int&gt;        &lt;dbl&gt;
1 A        150         85        0.567
2 B        200         83        0.415</code></pre>
</div>
</div>
<p>A simple bar plot can also help visualize the differences:</p>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">policy_summary</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, y <span class="op">=</span> <span class="va">prop_support</span>, fill <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">'identity'</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Region'</span>, </span>
<span>    y <span class="op">=</span> <span class="st">''</span>,</span>
<span>    title <span class="op">=</span> <span class="st">'Proportion of Policy Supporters by Region'</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">22</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>    strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">'none'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter3-two-pop_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="testing-settings-4" class="level3" data-number="3.5.5"><h3 data-number="3.5.5" class="anchored" data-anchor-id="testing-settings-4">
<span class="header-section-number">3.5.5</span> Testing Settings</h3>
<p>We use a significance level of <span class="math inline">\(\alpha = 0.05\)</span>. The population parameters are:</p>
<ul>
<li><p><span class="math inline">\(p_A\)</span>: true proportion of supporters in Region A.</p></li>
<li><p><span class="math inline">\(p_B\)</span>: true proportion of supporters in Region B.</p></li>
</ul>
<p>The goal is to test if the difference <span class="math inline">\(p_A - p_B\)</span> is significantly different from zero.</p>
</section><section id="hypothesis-definitions-4" class="level3" data-number="3.5.6"><h3 data-number="3.5.6" class="anchored" data-anchor-id="hypothesis-definitions-4">
<span class="header-section-number">3.5.6</span> Hypothesis Definitions</h3>
<p>The null and alternative hypotheses are:</p>
<p><span class="math display">\[H_0:p_A = p_B \quad vs \quad H_1:p_A \neq p_B\]</span></p>
</section><section id="test-flavour-and-components-4" class="level3" data-number="3.5.7"><h3 data-number="3.5.7" class="anchored" data-anchor-id="test-flavour-and-components-4">
<span class="header-section-number">3.5.7</span> Test Flavour and Components</h3>
<p>The two-sample <code>z-test</code> for proportions is the appropriate method for testing this hypothesis. As with any hypothesis test, we first need to compute the test statistic. For this test, we calculate the pooled proportion as</p>
<p><span class="math display">\[\hat p = \frac{x_A + x_B}{n_A + n_B}\]</span></p>
<p>where <span class="math inline">\(x_A\)</span> and <span class="math inline">\(x_B\)</span> are the counts of successes in the two samples and <span class="math inline">\(n_A\)</span> and <span class="math inline">\(n_B\)</span> are the respective sample sizes. The z-statistic is then computed as:</p>
<p><span id="eq-z-statistic-proportion"><span class="math display">\[z = \frac{\hat p_A - \hat p_B}{ \hat p (1 - \hat p) \left( \frac{1}{n_1} + \frac{1}{n_2} \right)} \tag{3.7}\]</span></span></p>
<p>Under <span class="math inline">\(H_0\)</span>, the statistic defined in <a href="#eq-z-statistic-proportion" class="quarto-xref">Equation&nbsp;<span>3.7</span></a> approximately follows a standard normal distribution for large sample sizes. The <span class="math inline">\(\texttt{p-value}\)</span> is then calculated as:</p>
<p><span class="math display">\[\texttt{p-value} = 2 \times Pr(Z \ge |z|)\]</span></p>
<div class="Tip">
<div class="Tip-header">
<p>Standard Normal and Chi-square</p>
</div>
<div class="Tip-container">
<ul>
<li><p>The test statistic for comparing two proportions can also be expressed as a chi-squared statistic <span class="math inline">\(\chi^2\)</span> which under the null hypothesis approximately follows a chi-squared distribution with 1 degree of freedom.</p></li>
<li><p>For large sample sizes, it can be shown that this statistic is closely related to the square of the z-statistic (i.e.&nbsp;<span class="math inline">\(X^2 \approx z^2\)</span>) providing an equivalent measure of the difference between proportions.</p></li>
</ul>
</div>
</div>
</section><section id="inferential-conclusions-4" class="level3" data-number="3.5.8"><h3 data-number="3.5.8" class="anchored" data-anchor-id="inferential-conclusions-4">
<span class="header-section-number">3.5.8</span> Inferential Conclusions</h3>
<p>If the <span class="math inline">\(\textit{p-value}\)</span> is smaller than <span class="math inline">\(\alpha = 0.05\)</span>, we reject <span class="math inline">\(H_0\)</span>, indicating a significant difference in policy support between the two regions. Otherwise, we fail to reject <span class="math inline">\(H_0\)</span>, suggesting no evidence of a difference.</p>
</section><section id="how-to-run-the-two-sample-paired-t-test-in-r-and-python-1" class="level3" data-number="3.5.9"><h3 data-number="3.5.9" class="anchored" data-anchor-id="how-to-run-the-two-sample-paired-t-test-in-r-and-python-1">
<span class="header-section-number">3.5.9</span> How to run the two-sample paired t-test in <code>R</code> and <code>Python</code>
</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using policy_summary to get counts and sample sizes</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">policy_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">supporters</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">policy_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">'B'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">supporters</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="va">policy_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n2</span> <span class="op">&lt;-</span> <span class="va">policy_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">'B'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run two-proportion z-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  c(x1, x2) out of c(n1, n2)
X-squared = 7.3034, df = 1, p-value = 0.006883
alternative hypothesis: two.sided
95 percent confidence interval:
 0.04118315 0.26215018
sample estimates:
   prop 1    prop 2 
0.5666667 0.4150000 </code></pre>
</div>
</div>
<p>The <code>R</code> output contains the following components:</p>
<ul>
<li><p><code>X-squared:</code> The chi-squared test statistic for comparing the two proportions; under the null hypothesis, it approximately follows a chi-squared distribution with 1 degree of freedom - provided a large sample size.</p></li>
<li><p><code>df:</code> Degrees of freedom for the chi-squared statistic (usually 1 for a two-sample test).</p></li>
<li><p><code>p-value:</code> The p-value of the test.</p></li>
<li><p><code>sample estimates:</code> The sample proportions for each group.</p></li>
<li><p><code>95 percent confidence interval:</code> The confidence interval for the difference in proportions.</p></li>
</ul>
<div class="Tip">
<div class="Tip-header">
<p>Note on continuity correction</p>
</div>
<div class="Tip-container">
<ul>
<li><p>You notice <code>with continuity correction</code> in the <code>R</code> output of <code>prop.test</code> function. The continuity correction is a small adjustment applied when using a continuous probability distribution (like the normal distribution) to approximate a discrete distribution (like the binomial) in hypothesis testing.</p></li>
<li><p>When approximating a discrete distribution, such as the difference in two sample proportions, with a continuous normal distribution, a continuity correction can be applied to improve the approximation. This involves subtracting (or adding) 0.5 in the numerator of the test statistic (scaled appropriately by sample sizes) to account for the fact that the underlying counts are discrete.</p></li>
<li><p>The effect of this correction is most noticeable with small sample sizes and becomes negligible as sample sizes increase.</p></li>
<li><p>This can be controlled in <code>prop.test</code> function by setting <code>correct = TRUE</code> (default value) to include continuity correction or <code>correct = FALSE</code> to not include this.</p></li>
</ul>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.proportion <span class="im">import</span> proportions_ztest</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>policy_summary <span class="op">=</span> pd.read_csv(<span class="st">'data/policy_summary.csv'</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract counts and sample sizes</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> policy_summary.loc[policy_summary[<span class="st">'region'</span>] <span class="op">==</span> <span class="st">'A'</span>, <span class="st">'supporters'</span>].values[<span class="dv">0</span>]</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> policy_summary.loc[policy_summary[<span class="st">'region'</span>] <span class="op">==</span> <span class="st">'B'</span>, <span class="st">'supporters'</span>].values[<span class="dv">0</span>]</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>n1 <span class="op">=</span> policy_summary.loc[policy_summary[<span class="st">'region'</span>] <span class="op">==</span> <span class="st">'A'</span>, <span class="st">'n'</span>].values[<span class="dv">0</span>]</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>n2 <span class="op">=</span> policy_summary.loc[policy_summary[<span class="st">'region'</span>] <span class="op">==</span> <span class="st">'B'</span>, <span class="st">'n'</span>].values[<span class="dv">0</span>]</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> [x1, x2]</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>nobs <span class="op">=</span> [n1, n2]</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>stat, pval <span class="op">=</span> proportions_ztest(count, nobs)</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Z-statistic: </span><span class="sc">{</span>stat<span class="sc">:.4f}</span><span class="ss">, p-value: </span><span class="sc">{</span>pval<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Z-statistic: 2.8106, p-value: 0.0049</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="Heads-up">
<div class="Heads-up-header">
<p>Heads-up!</p>
</div>
<div class="Heads-up-container">
<ul>
<li><p>Note that <code>proportions_ztest</code> function from <code>statsmodels.stats.proportion</code> does <strong>NOT</strong> provide an argument to control the implementation of continuity correction and by default it doe not make any correction.</p></li>
<li><p>As a result the results between <code>R</code> and <code>Python</code> differes. You can write a function in <code>Python</code> to apply this correction and then compute the <code>p-value</code> accordingly but it is not the scope of this textbook.</p></li>
</ul>
</div>
</div>
</section><section id="storytelling-4" class="level3" data-number="3.5.10"><h3 data-number="3.5.10" class="anchored" data-anchor-id="storytelling-4">
<span class="header-section-number">3.5.10</span> Storytelling</h3>
<p>We surveyed people in two regions to see how much support there is for a new environmental policy. In Region A, a little over half of the participants (57%) were in favor, while in Region B, only about 42% supported it. Statistical testing confirmed that this difference is unlikely to be due to chance: the results suggest that support in Region A is genuinely higher than in Region B with <code>p-value = 0.0068</code>. In fact, we can be reasonably confident that the true difference in support between the regions lies somewhere between 4% and 26%.</p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pnickchi\.github\.io\/test-book\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../book/chapter2-one-pop.html" class="pagination-link" aria-label="Tests for One Continuous Population Mean">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tests for One Continuous Population Mean</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../book/chapter4-anova.html" class="pagination-link" aria-label="ANOVA-related Tests for $k$ Continuous Population Means">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">ANOVA-related Tests for <span class="math inline">\(k\)</span> Continuous Population Means</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025; G. Alexi Rodríguez-Arelis, Kate Manskaia, and Payman Nickchi<br><a href="https://www.flaticon.com/free-icon/toolkit_4229807?term=tool+box&amp;page=1&amp;position=24&amp;origin=tag&amp;related_id=4229807" title="toolkit icons">Toolkit icon created by Freepik - Flaticon</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/pnickchi/test-book/edit/main/book/chapter3-two-pop.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/pnickchi/test-book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/pnickchi/test-book/blob/main/book/chapter3-two-pop.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>